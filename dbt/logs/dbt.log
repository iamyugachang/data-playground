[0m13:13:48.645495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660b8908610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660b78c8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660b78c87c0>]}


============================== 13:13:48.649076 | 55681e71-bc5c-46cb-aaa1-ee7f15362ac4 ==============================
[0m13:13:48.649076 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:13:48.649827 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/usr/app/dbt_project/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/root/.dbt'}
[0m13:13:48.664045 [info ] [MainThread]: dbt version: 1.11.2
[0m13:13:48.665364 [info ] [MainThread]: python version: 3.10.19
[0m13:13:48.666499 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m13:13:48.667011 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m13:13:48.779822 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:13:48.780987 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:13:48.782226 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m13:13:48.783258 [info ] [MainThread]: adapter type: trino
[0m13:13:48.784259 [info ] [MainThread]: adapter version: 1.10.0
[0m13:13:49.131303 [info ] [MainThread]: Configuration:
[0m13:13:49.132452 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:13:49.133759 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:13:49.134929 [info ] [MainThread]: Required dependencies:
[0m13:13:49.135874 [debug] [MainThread]: Executing "git --help"
[0m13:13:49.147578 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:13:49.148279 [debug] [MainThread]: STDERR: "b''"
[0m13:13:49.148690 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:13:49.149163 [info ] [MainThread]: Connection:
[0m13:13:49.149622 [info ] [MainThread]:   host: trino
[0m13:13:49.150084 [info ] [MainThread]:   port: 8080
[0m13:13:49.150526 [info ] [MainThread]:   user: admin
[0m13:13:49.150929 [info ] [MainThread]:   database: iceberg
[0m13:13:49.151392 [info ] [MainThread]:   schema: public
[0m13:13:49.151797 [info ] [MainThread]:   cert: None
[0m13:13:49.152187 [info ] [MainThread]:   prepared_statements_enabled: True
[0m13:13:49.152750 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m13:13:49.272604 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m13:13:49.343542 [debug] [MainThread]: Using trino connection "debug"
[0m13:13:49.344182 [debug] [MainThread]: On debug: select 1 as id
[0m13:13:49.344636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:49.344987 [warn ] [MainThread]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:13:49.345662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '55681e71-bc5c-46cb-aaa1-ee7f15362ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660b75ee440>]}
[0m13:13:49.459819 [debug] [MainThread]: SQL status: SUCCESS in 0.115 seconds
[0m13:13:49.461178 [debug] [MainThread]: On debug: Close
[0m13:13:49.462235 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:13:49.462923 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:13:49.465105 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.92768866, "process_in_blocks": "0", "process_kernel_time": 0.412862, "process_mem_max_rss": "108456", "process_out_blocks": "952", "process_user_time": 2.62289}
[0m13:13:49.465991 [debug] [MainThread]: Command `dbt debug` succeeded at 13:13:49.465814 after 0.93 seconds
[0m13:13:49.466588 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:13:49.467306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660b8908610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660b7883d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7660b89a3e80>]}
[0m13:13:49.468035 [debug] [MainThread]: Flushing usage events
[0m13:13:50.415312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:10.605957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d30214c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d301110580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d301110520>]}


============================== 13:14:10.609205 | f4a6b644-737e-40c9-aba7-25f16bef2b36 ==============================
[0m13:14:10.609205 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:14:10.609990 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'empty': 'False', 'target_path': 'None', 'profiles_dir': '/root/.dbt', 'introspect': 'True', 'log_path': '/usr/app/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m13:14:10.956757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d301933a90>]}
[0m13:14:11.072608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3012a0160>]}
[0m13:14:11.073495 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m13:14:11.203183 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:14:11.204108 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:14:11.205224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d300e838b0>]}
[0m13:14:13.093670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d2fbdda050>]}
[0m13:14:13.247727 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:14:13.253716 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:14:13.274751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d2fbd98f10>]}
[0m13:14:13.275474 [info ] [MainThread]: Found 3 models, 3 sources, 455 macros
[0m13:14:13.275981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d2fbddb400>]}
[0m13:14:13.286490 [info ] [MainThread]: 
[0m13:14:13.287240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:13.287792 [info ] [MainThread]: 
[0m13:14:13.288466 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:14:13.298756 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:14:13.432553 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:14:13.433108 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:14:13.433612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:13.434318 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:14:13.435205 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d300882110>]}
[0m13:14:13.667359 [debug] [ThreadPool]: SQL status: SUCCESS in 0.234 seconds
[0m13:14:13.669903 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:14:13.673379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_public)
[0m13:14:13.674353 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "public"
"
[0m13:14:13.681871 [debug] [ThreadPool]: Using trino connection "create_iceberg_public"
[0m13:14:13.682453 [debug] [ThreadPool]: On create_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_iceberg_public"} */
create schema if not exists "iceberg"."public"
[0m13:14:13.682859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:13.930532 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.103 seconds
[0m13:14:13.932017 [debug] [ThreadPool]: On create_iceberg_public: COMMIT
[0m13:14:13.932559 [debug] [ThreadPool]: On create_iceberg_public: Close
[0m13:14:13.934719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_public, now list_iceberg_public)
[0m13:14:13.956581 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m13:14:13.957181 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m13:14:13.957607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:14.670860 [debug] [ThreadPool]: SQL status: SUCCESS in 0.713 seconds
[0m13:14:14.672562 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m13:14:14.673224 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m13:14:14.678388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3025d0ac0>]}
[0m13:14:14.679175 [debug] [MainThread]: On master: COMMIT
[0m13:14:14.688886 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_customers
[0m13:14:14.689460 [debug] [Thread-2 (]: Began running node model.dbt_playground.stg_events
[0m13:14:14.690442 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_customers ............................... [RUN]
[0m13:14:14.691148 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_events .................................. [RUN]
[0m13:14:14.692642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now model.dbt_playground.stg_customers)
[0m13:14:14.693483 [debug] [Thread-2 (]: Acquiring new trino connection 'model.dbt_playground.stg_events'
[0m13:14:14.694228 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_customers
[0m13:14:14.694835 [debug] [Thread-2 (]: Began compiling node model.dbt_playground.stg_events
[0m13:14:14.698937 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_customers"
[0m13:14:14.704956 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m13:14:14.707418 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_customers
[0m13:14:14.724757 [debug] [Thread-2 (]: Began executing node model.dbt_playground.stg_events
[0m13:14:14.742516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_customers"
[0m13:14:14.745373 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m13:14:14.749420 [debug] [Thread-2 (]: Using trino connection "model.dbt_playground.stg_events"
[0m13:14:14.751535 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  create or replace view
    "iceberg"."public"."stg_events"
  security definer
  as
    select
    event_id,
    user_id as customer_id,
    event_type,
    event_time
from "iceberg"."data"."events"
  
[0m13:14:14.752196 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:14:14.753824 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.stg_customers"
[0m13:14:14.756360 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_customers"} */

  create or replace view
    "iceberg"."public"."stg_customers"
  security definer
  as
    select
    id as customer_id,
    name,
    email
from "postgres"."public"."customers"
  
[0m13:14:14.757269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:15.657149 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.905 seconds
[0m13:14:15.689319 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: ROLLBACK
[0m13:14:15.695356 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: Close
[0m13:14:15.702062 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3025d3160>]}
[0m13:14:15.703193 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_events ............................. [[32mCREATE VIEW[0m in 1.00s]
[0m13:14:15.704130 [debug] [Thread-2 (]: Finished running node model.dbt_playground.stg_events
[0m13:14:15.794630 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.037 seconds
[0m13:14:15.797196 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: ROLLBACK
[0m13:14:15.797752 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: Close
[0m13:14:15.798854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d30081ecb0>]}
[0m13:14:15.799794 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 1.11s]
[0m13:14:15.800617 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_customers
[0m13:14:15.802884 [debug] [Thread-4 (]: Began running node model.dbt_playground.customer_activity
[0m13:14:15.803887 [info ] [Thread-4 (]: 3 of 3 START sql table model public.customer_activity .......................... [RUN]
[0m13:14:15.804878 [debug] [Thread-4 (]: Acquiring new trino connection 'model.dbt_playground.customer_activity'
[0m13:14:15.805426 [debug] [Thread-4 (]: Began compiling node model.dbt_playground.customer_activity
[0m13:14:15.811504 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_playground.customer_activity"
[0m13:14:15.813037 [debug] [Thread-4 (]: Began executing node model.dbt_playground.customer_activity
[0m13:14:15.886635 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_playground.customer_activity"
[0m13:14:15.890916 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_activity"
[0m13:14:15.891505 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_activity"} */

  
    

    create table "iceberg"."public"."customer_activity"
      
      
    as (
      with customers as (
    select * from "iceberg"."public"."stg_customers"
),
events as (
    select * from "iceberg"."public"."stg_events"
)
select
    c.customer_id,
    c.name,
    count(e.event_id) as total_events
from customers c
left join events e on c.customer_id = e.customer_id
group by 1, 2
    )
[0m13:14:15.891997 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:14:17.814339 [debug] [Thread-4 (]: SQL status: CREATE TABLE (3 rows) in 1.922 seconds
[0m13:14:17.817730 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: ROLLBACK
[0m13:14:17.818493 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: Close
[0m13:14:17.819722 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4a6b644-737e-40c9-aba7-25f16bef2b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3009e59f0>]}
[0m13:14:17.820789 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.customer_activity ..................... [[32mCREATE TABLE (3 rows)[0m in 2.01s]
[0m13:14:17.821765 [debug] [Thread-4 (]: Finished running node model.dbt_playground.customer_activity
[0m13:14:17.826237 [debug] [MainThread]: On master: COMMIT
[0m13:14:17.826923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:17.827332 [debug] [MainThread]: Connection 'model.dbt_playground.stg_customers' was properly closed.
[0m13:14:17.827714 [debug] [MainThread]: Connection 'model.dbt_playground.stg_events' was properly closed.
[0m13:14:17.828056 [debug] [MainThread]: Connection 'model.dbt_playground.customer_activity' was properly closed.
[0m13:14:17.828676 [info ] [MainThread]: 
[0m13:14:17.829296 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m13:14:17.831346 [debug] [MainThread]: Command end result
[0m13:14:17.871509 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:14:17.873901 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:14:17.883554 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:14:17.884457 [info ] [MainThread]: 
[0m13:14:17.885105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:17.885585 [info ] [MainThread]: 
[0m13:14:17.886138 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:14:17.887502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.242139, "process_in_blocks": "0", "process_kernel_time": 0.389364, "process_mem_max_rss": "124700", "process_out_blocks": "2856", "process_user_time": 5.025239}
[0m13:14:17.888351 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:17.888193 after 7.24 seconds
[0m13:14:17.888861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d30214c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3021e66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3008581c0>]}
[0m13:14:17.889376 [debug] [MainThread]: Flushing usage events
[0m13:14:18.716056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:59.779043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1d17e4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1d07a4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1d07a4700>]}


============================== 13:14:59.782759 | 44e29c30-f4c8-4417-932c-2f5d453f3a30 ==============================
[0m13:14:59.782759 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:14:59.784226 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs generate', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'empty': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'printer_width': '80', 'target_path': 'None'}
[0m13:15:00.102474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44e29c30-f4c8-4417-932c-2f5d453f3a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1d07a4790>]}
[0m13:15:00.222203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44e29c30-f4c8-4417-932c-2f5d453f3a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1d01fb370>]}
[0m13:15:00.223239 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m13:15:00.351839 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:15:00.533310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:15:00.533898 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:15:00.534247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:15:00.587904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44e29c30-f4c8-4417-932c-2f5d453f3a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1cff4e260>]}
[0m13:15:00.597268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44e29c30-f4c8-4417-932c-2f5d453f3a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1cff14370>]}
[0m13:15:00.598152 [info ] [MainThread]: Found 3 models, 3 sources, 455 macros
[0m13:15:00.598701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e29c30-f4c8-4417-932c-2f5d453f3a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1cff14070>]}
[0m13:15:00.600994 [info ] [MainThread]: 
[0m13:15:00.601620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:15:00.603043 [info ] [MainThread]: 
[0m13:15:00.604810 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:15:00.612449 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public'
[0m13:15:00.748501 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m13:15:00.749175 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m13:15:00.749798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:00.750138 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:15:00.752514 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '44e29c30-f4c8-4417-932c-2f5d453f3a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1d02f83d0>]}
[0m13:15:01.136120 [debug] [ThreadPool]: SQL status: SUCCESS in 0.386 seconds
[0m13:15:01.137991 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m13:15:01.138597 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m13:15:01.142997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e29c30-f4c8-4417-932c-2f5d453f3a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1cfef85b0>]}
[0m13:15:01.150571 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_customers
[0m13:15:01.151331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now model.dbt_playground.stg_customers)
[0m13:15:01.152004 [debug] [Thread-2 (]: Began running node model.dbt_playground.stg_events
[0m13:15:01.152705 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_customers
[0m13:15:01.153494 [debug] [Thread-2 (]: Acquiring new trino connection 'model.dbt_playground.stg_events'
[0m13:15:01.157872 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_customers"
[0m13:15:01.158841 [debug] [Thread-2 (]: Began compiling node model.dbt_playground.stg_events
[0m13:15:01.164496 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m13:15:01.165699 [debug] [Thread-2 (]: Began executing node model.dbt_playground.stg_events
[0m13:15:01.166411 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_customers
[0m13:15:01.167541 [debug] [Thread-2 (]: Finished running node model.dbt_playground.stg_events
[0m13:15:01.168714 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_customers
[0m13:15:01.170527 [debug] [Thread-4 (]: Began running node model.dbt_playground.customer_activity
[0m13:15:01.171493 [debug] [Thread-4 (]: Acquiring new trino connection 'model.dbt_playground.customer_activity'
[0m13:15:01.172063 [debug] [Thread-4 (]: Began compiling node model.dbt_playground.customer_activity
[0m13:15:01.176525 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_playground.customer_activity"
[0m13:15:01.177710 [debug] [Thread-4 (]: Began executing node model.dbt_playground.customer_activity
[0m13:15:01.178998 [debug] [Thread-4 (]: Finished running node model.dbt_playground.customer_activity
[0m13:15:01.181741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:01.182271 [debug] [MainThread]: Connection 'model.dbt_playground.stg_customers' was properly closed.
[0m13:15:01.182651 [debug] [MainThread]: Connection 'model.dbt_playground.stg_events' was properly closed.
[0m13:15:01.183010 [debug] [MainThread]: Connection 'model.dbt_playground.customer_activity' was properly closed.
[0m13:15:01.184089 [debug] [MainThread]: Command end result
[0m13:15:01.305119 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:15:01.307323 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:15:01.316892 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:15:01.322035 [debug] [MainThread]: Acquiring new trino connection 'generate_catalog'
[0m13:15:01.322497 [info ] [MainThread]: Building catalog
[0m13:15:01.326134 [debug] [ThreadPool]: Acquiring new trino connection 'iceberg.information_schema'
[0m13:15:01.327453 [debug] [ThreadPool]: Acquiring new trino connection 'postgres.information_schema'
[0m13:15:01.386039 [debug] [ThreadPool]: Using trino connection "postgres.information_schema"
[0m13:15:01.392120 [debug] [ThreadPool]: Using trino connection "iceberg.information_schema"
[0m13:15:01.392814 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "postgres".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'public'
                        and table_name = 'customers'
                    )
                 or 
                    (
                        table_schema = 'public'
                        and table_name = 'products'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "postgres".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'public'
                        and table_name = 'customers'
                    )
                 or 
                    (
                        table_schema = 'public'
                        and table_name = 'products'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'postgres'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'public'
                    and table_name = 'customers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'postgres'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'public'
                    and table_name = 'products'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m13:15:01.393808 [debug] [ThreadPool]: On iceberg.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "iceberg.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "iceberg".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'public'
                        and table_name = 'stg_events'
                    )
                 or 
                    (
                        table_schema = 'public'
                        and table_name = 'stg_customers'
                    )
                 or 
                    (
                        table_schema = 'data'
                        and table_name = 'events'
                    )
                 or 
                    (
                        table_schema = 'public'
                        and table_name = 'customer_activity'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "iceberg".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'public'
                        and table_name = 'stg_events'
                    )
                 or 
                    (
                        table_schema = 'public'
                        and table_name = 'stg_customers'
                    )
                 or 
                    (
                        table_schema = 'data'
                        and table_name = 'events'
                    )
                 or 
                    (
                        table_schema = 'public'
                        and table_name = 'customer_activity'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'public'
                    and table_name = 'stg_events'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'public'
                    and table_name = 'stg_customers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'data'
                    and table_name = 'events'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'public'
                    and table_name = 'customer_activity'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m13:15:01.394823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:01.395483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:02.683595 [debug] [ThreadPool]: SQL status: SUCCESS in 1.289 seconds
[0m13:15:02.692497 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m13:15:03.269912 [debug] [ThreadPool]: SQL status: SUCCESS in 1.874 seconds
[0m13:15:03.273923 [debug] [ThreadPool]: On iceberg.information_schema: Close
[0m13:15:03.322537 [debug] [MainThread]: Wrote artifact CatalogArtifact to /usr/app/dbt_project/target/catalog.json
[0m13:15:03.365159 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:15:03.369757 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:15:03.371258 [info ] [MainThread]: Catalog written to /usr/app/dbt_project/target/catalog.json
[0m13:15:03.372950 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.698727, "process_in_blocks": "0", "process_kernel_time": 0.362305, "process_mem_max_rss": "116136", "process_out_blocks": "5288", "process_user_time": 3.097918}
[0m13:15:03.374350 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:15:03.373535 after 3.70 seconds
[0m13:15:03.374978 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:15:03.375421 [debug] [MainThread]: Connection 'iceberg.information_schema' was properly closed.
[0m13:15:03.376534 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.
[0m13:15:03.377785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1d17e4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1cfef8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1cfefb520>]}
[0m13:15:03.378375 [debug] [MainThread]: Flushing usage events
[0m13:15:04.207243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:21.442833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8018142e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8007b4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8007b45b0>]}


============================== 13:15:21.446004 | f1ddb4a3-4c3a-44bc-b9ea-c15045c8b771 ==============================
[0m13:15:21.446004 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:15:21.446765 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_path': '/usr/app/dbt_project/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'invocation_command': 'dbt docs serve --port 8081 --host 0.0.0.0', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False'}
[0m13:15:21.752880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1ddb4a3-4c3a-44bc-b9ea-c15045c8b771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8016cff40>]}
[0m13:15:21.880153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1ddb4a3-4c3a-44bc-b9ea-c15045c8b771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b80100ed40>]}
[0m13:20:06.631781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac3fa458250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac3f93f8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac3f93f82e0>]}


============================== 13:20:06.635727 | 60243535-c506-45a8-996c-5bba33f40712 ==============================
[0m13:20:06.635727 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:20:06.636454 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'empty': 'None', 'no_print': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False'}
[0m13:20:06.642876 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`dbt_playground.staging.materialized` in file
`/usr/app/dbt_project/dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m13:20:06.643613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '60243535-c506-45a8-996c-5bba33f40712', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac3f93f8ac0>]}
[0m13:20:06.867342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60243535-c506-45a8-996c-5bba33f40712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac3f93f8d30>]}
[0m13:20:06.882523 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:20:06.884040 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:20:06.884868 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:20:06.887997 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3792293, "process_in_blocks": "56", "process_kernel_time": 0.485225, "process_mem_max_rss": "99844", "process_out_blocks": "8", "process_user_time": 2.140702}
[0m13:20:06.888689 [debug] [MainThread]: Command `dbt deps` succeeded at 13:20:06.888533 after 0.38 seconds
[0m13:20:06.889346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac3fa458250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac3f93f8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac3fc0d1150>]}
[0m13:20:06.889852 [debug] [MainThread]: Flushing usage events
[0m13:20:07.720728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:36.000722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070a2a682b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070a1a103d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070a1a10370>]}


============================== 13:20:36.004177 | d3d05c71-9f97-4518-b9cd-c5f24a06b91a ==============================
[0m13:20:36.004177 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:20:36.004927 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/usr/app/dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True'}
[0m13:20:36.016832 [info ] [MainThread]: dbt version: 1.11.2
[0m13:20:36.017529 [info ] [MainThread]: python version: 3.10.19
[0m13:20:36.017937 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m13:20:36.018318 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m13:20:36.112814 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:20:36.114103 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:20:36.116134 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m13:20:36.116666 [info ] [MainThread]: adapter type: trino
[0m13:20:36.117055 [info ] [MainThread]: adapter version: 1.10.0
[0m13:20:36.308137 [info ] [MainThread]: Configuration:
[0m13:20:36.308706 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:20:36.309848 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:20:36.310972 [info ] [MainThread]: Required dependencies:
[0m13:20:36.311496 [debug] [MainThread]: Executing "git --help"
[0m13:20:36.314798 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:20:36.315442 [debug] [MainThread]: STDERR: "b''"
[0m13:20:36.315898 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:20:36.316317 [info ] [MainThread]: Connection:
[0m13:20:36.316737 [info ] [MainThread]:   host: trino
[0m13:20:36.317225 [info ] [MainThread]:   port: 8080
[0m13:20:36.317573 [info ] [MainThread]:   user: admin
[0m13:20:36.317988 [info ] [MainThread]:   database: iceberg
[0m13:20:36.318329 [info ] [MainThread]:   schema: public
[0m13:20:36.318737 [info ] [MainThread]:   cert: None
[0m13:20:36.319180 [info ] [MainThread]:   prepared_statements_enabled: True
[0m13:20:36.319792 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m13:20:36.428707 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m13:20:36.474829 [debug] [MainThread]: Using trino connection "debug"
[0m13:20:36.475991 [debug] [MainThread]: On debug: select 1 as id
[0m13:20:36.476516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:36.477030 [warn ] [MainThread]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:20:36.478254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'd3d05c71-9f97-4518-b9cd-c5f24a06b91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070a171f1f0>]}
[0m13:20:36.560315 [debug] [MainThread]: SQL status: SUCCESS in 0.084 seconds
[0m13:20:36.561611 [debug] [MainThread]: On debug: Close
[0m13:20:36.562266 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:20:36.562791 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:20:36.564422 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6674434, "process_in_blocks": "0", "process_kernel_time": 0.224509, "process_mem_max_rss": "107800", "process_out_blocks": "24", "process_user_time": 2.347145}
[0m13:20:36.565487 [debug] [MainThread]: Command `dbt debug` succeeded at 13:20:36.565311 after 0.67 seconds
[0m13:20:36.567500 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:20:36.568222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070a2a682b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070a1937af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7070a2af6500>]}
[0m13:20:36.568909 [debug] [MainThread]: Flushing usage events
[0m13:20:37.402403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:43.252213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f2a2042b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f291984c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f29198460>]}


============================== 13:20:43.257516 | 06e84ea3-b0f0-4ea9-b3b9-782960984167 ==============================
[0m13:20:43.257516 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:20:43.260258 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'log_path': '/usr/app/dbt_project/logs', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m13:20:43.708313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f2be7d0c0>]}
[0m13:20:43.823826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f294febc0>]}
[0m13:20:43.824718 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m13:20:43.946552 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:20:44.097726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:44.098191 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:20:44.098534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:44.151264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f28946020>]}
[0m13:20:44.320342 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:20:44.322916 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:20:44.330929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f28975300>]}
[0m13:20:44.331675 [info ] [MainThread]: Found 3 models, 3 sources, 455 macros
[0m13:20:44.332305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f28975240>]}
[0m13:20:44.334722 [info ] [MainThread]: 
[0m13:20:44.335346 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:44.335748 [info ] [MainThread]: 
[0m13:20:44.336389 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:20:44.343497 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:20:44.409272 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:20:44.409777 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:20:44.410143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:44.410467 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:20:44.411134 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f29335c90>]}
[0m13:20:44.524853 [debug] [ThreadPool]: SQL status: SUCCESS in 0.115 seconds
[0m13:20:44.526411 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:20:44.528416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_public)
[0m13:20:44.552638 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m13:20:44.553254 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m13:20:44.553696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:44.792907 [debug] [ThreadPool]: SQL status: SUCCESS in 0.239 seconds
[0m13:20:44.794675 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m13:20:44.795196 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m13:20:44.797171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f294fe110>]}
[0m13:20:44.797779 [debug] [MainThread]: On master: COMMIT
[0m13:20:44.803095 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_customers
[0m13:20:44.803707 [debug] [Thread-2 (]: Began running node model.dbt_playground.stg_events
[0m13:20:44.804608 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_customers ............................... [RUN]
[0m13:20:44.806458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now model.dbt_playground.stg_customers)
[0m13:20:44.805358 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_events .................................. [RUN]
[0m13:20:44.807217 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_customers
[0m13:20:44.808271 [debug] [Thread-2 (]: Acquiring new trino connection 'model.dbt_playground.stg_events'
[0m13:20:44.813882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_customers"
[0m13:20:44.814729 [debug] [Thread-2 (]: Began compiling node model.dbt_playground.stg_events
[0m13:20:44.820644 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m13:20:44.821313 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_customers
[0m13:20:44.821997 [debug] [Thread-2 (]: Began executing node model.dbt_playground.stg_events
[0m13:20:44.860713 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_customers"
[0m13:20:44.861431 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m13:20:44.863337 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.stg_customers"
[0m13:20:44.864925 [debug] [Thread-2 (]: Using trino connection "model.dbt_playground.stg_events"
[0m13:20:44.865497 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_customers"} */

  create or replace view
    "iceberg"."public"."stg_customers"
  security definer
  as
    select
    id as customer_id,
    name,
    email
from "postgres"."public"."customers"
  
[0m13:20:44.866021 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  create or replace view
    "iceberg"."public"."stg_events"
  security definer
  as
    select
    event_id,
    user_id as customer_id,
    event_type,
    event_time
from "iceberg"."data"."events"
  
[0m13:20:44.866502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:44.866999 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:20:45.233285 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.366 seconds
[0m13:20:45.248219 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.382 seconds
[0m13:20:45.279517 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: ROLLBACK
[0m13:20:45.280150 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: ROLLBACK
[0m13:20:45.280729 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: Close
[0m13:20:45.281227 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: Close
[0m13:20:45.284314 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f23d55360>]}
[0m13:20:45.284963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f28f15060>]}
[0m13:20:45.286040 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_events ............................. [[32mCREATE VIEW[0m in 0.47s]
[0m13:20:45.287082 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.48s]
[0m13:20:45.288661 [debug] [Thread-2 (]: Finished running node model.dbt_playground.stg_events
[0m13:20:45.289514 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_customers
[0m13:20:45.291828 [debug] [Thread-4 (]: Began running node model.dbt_playground.customer_activity
[0m13:20:45.292751 [info ] [Thread-4 (]: 3 of 3 START sql table model public.customer_activity .......................... [RUN]
[0m13:20:45.293457 [debug] [Thread-4 (]: Acquiring new trino connection 'model.dbt_playground.customer_activity'
[0m13:20:45.293933 [debug] [Thread-4 (]: Began compiling node model.dbt_playground.customer_activity
[0m13:20:45.297943 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_playground.customer_activity"
[0m13:20:45.298790 [debug] [Thread-4 (]: Began executing node model.dbt_playground.customer_activity
[0m13:20:45.364520 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_playground.customer_activity"
[0m13:20:45.367328 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_activity"
[0m13:20:45.367977 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_activity"} */

  
    

    create table "iceberg"."public"."customer_activity__dbt_tmp"
      
      
    as (
      with customers as (
    select * from "iceberg"."public"."stg_customers"
),
events as (
    select * from "iceberg"."public"."stg_events"
)
select
    c.customer_id,
    c.name,
    count(e.event_id) as total_events
from customers c
left join events e on c.customer_id = e.customer_id
group by 1, 2
    )
[0m13:20:45.368553 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:20:46.413409 [debug] [Thread-4 (]: SQL status: CREATE TABLE (3 rows) in 0.868 seconds
[0m13:20:46.422551 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_activity"
[0m13:20:46.423115 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_activity"} */
alter table "iceberg"."public"."customer_activity" rename to "iceberg"."public"."customer_activity__dbt_backup"
[0m13:20:46.550222 [debug] [Thread-4 (]: SQL status: RENAME TABLE in 0.127 seconds
[0m13:20:46.555057 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_activity"
[0m13:20:46.555607 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_activity"} */
alter table "iceberg"."public"."customer_activity__dbt_tmp" rename to "iceberg"."public"."customer_activity"
[0m13:20:46.689264 [debug] [Thread-4 (]: SQL status: RENAME TABLE in 0.133 seconds
[0m13:20:46.699800 [debug] [Thread-4 (]: Applying DROP to: "iceberg"."public"."customer_activity__dbt_backup"
[0m13:20:46.702739 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_activity"
[0m13:20:46.703442 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_activity"} */

    drop table if exists "iceberg"."public"."customer_activity__dbt_backup"
[0m13:20:46.776574 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20260110_132041_00034_wjppr
[0m13:20:46.777353 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_activity__dbt_backup'", query_id=20260110_132041_00034_wjppr)
[0m13:20:46.778022 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: ROLLBACK
[0m13:20:46.778586 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: Close
[0m13:20:46.791563 [debug] [Thread-4 (]: Database Error in model customer_activity (models/marts/customer_activity.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_activity__dbt_backup'", query_id=20260110_132041_00034_wjppr)
  compiled code at target/run/dbt_playground/models/marts/customer_activity.sql
[0m13:20:46.793127 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e84ea3-b0f0-4ea9-b3b9-782960984167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f2893e290>]}
[0m13:20:46.794300 [error] [Thread-4 (]: 3 of 3 ERROR creating sql table model public.customer_activity ................. [[31mERROR[0m in 1.50s]
[0m13:20:46.795320 [debug] [Thread-4 (]: Finished running node model.dbt_playground.customer_activity
[0m13:20:46.796760 [debug] [Thread-7 (]: Marking all children of 'model.dbt_playground.customer_activity' to be skipped because of status 'error'.  Reason: Database Error in model customer_activity (models/marts/customer_activity.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_activity__dbt_backup'", query_id=20260110_132041_00034_wjppr)
  compiled code at target/run/dbt_playground/models/marts/customer_activity.sql.
[0m13:20:46.800427 [debug] [MainThread]: On master: COMMIT
[0m13:20:46.801029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:46.801415 [debug] [MainThread]: Connection 'model.dbt_playground.stg_customers' was properly closed.
[0m13:20:46.801750 [debug] [MainThread]: Connection 'model.dbt_playground.stg_events' was properly closed.
[0m13:20:46.802061 [debug] [MainThread]: Connection 'model.dbt_playground.customer_activity' was properly closed.
[0m13:20:46.802489 [info ] [MainThread]: 
[0m13:20:46.802925 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m13:20:46.804266 [debug] [MainThread]: Command end result
[0m13:20:46.868727 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:20:46.871030 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:20:46.881018 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:20:46.881532 [info ] [MainThread]: 
[0m13:20:46.881999 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:20:46.882449 [info ] [MainThread]: 
[0m13:20:46.882947 [error] [MainThread]: [31mFailure in model customer_activity (models/marts/customer_activity.sql)[0m
[0m13:20:46.883422 [error] [MainThread]:   Database Error in model customer_activity (models/marts/customer_activity.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_activity__dbt_backup'", query_id=20260110_132041_00034_wjppr)
  compiled code at target/run/dbt_playground/models/marts/customer_activity.sql
[0m13:20:46.883803 [info ] [MainThread]: 
[0m13:20:46.884250 [info ] [MainThread]:   compiled code at target/compiled/dbt_playground/models/marts/customer_activity.sql
[0m13:20:46.884688 [info ] [MainThread]: 
[0m13:20:46.885129 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:20:46.886907 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5739553, "process_in_blocks": "232", "process_kernel_time": 0.445706, "process_mem_max_rss": "118500", "process_out_blocks": "1944", "process_user_time": 3.397997}
[0m13:20:46.887744 [debug] [MainThread]: Command `dbt run` failed at 13:20:46.887566 after 3.58 seconds
[0m13:20:46.888233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f2a2042b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f2a294250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778f20c3ffd0>]}
[0m13:20:46.888730 [debug] [MainThread]: Flushing usage events
[0m13:20:47.723992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:27.709742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e52925442e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5291504520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e52915044c0>]}


============================== 13:27:27.713383 | 42ebbcf7-da9f-4682-b17a-e99a0299ec7d ==============================
[0m13:27:27.713383 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:27:27.714164 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/usr/app/dbt_project/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None'}
[0m13:27:28.059445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5291d2a8c0>]}
[0m13:27:28.174654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e52914be290>]}
[0m13:27:28.175614 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m13:27:28.321811 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:27:28.513566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:28.514123 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:27:28.514474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:28.577524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5290cba080>]}
[0m13:27:28.862598 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:27:28.865160 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:27:28.874771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5290ce88e0>]}
[0m13:27:28.875544 [info ] [MainThread]: Found 3 models, 3 sources, 455 macros
[0m13:27:28.876107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5290ce89a0>]}
[0m13:27:28.878234 [info ] [MainThread]: 
[0m13:27:28.879200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:28.879978 [info ] [MainThread]: 
[0m13:27:28.881099 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:27:28.888789 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:27:28.963860 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:27:28.964568 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:27:28.964971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:28.965316 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:27:28.965908 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5291495cf0>]}
[0m13:27:30.722972 [debug] [ThreadPool]: SQL status: SUCCESS in 1.758 seconds
[0m13:27:30.724992 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:27:30.727345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_public)
[0m13:27:30.751918 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m13:27:30.752519 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m13:27:30.752971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:31.653517 [debug] [ThreadPool]: SQL status: SUCCESS in 0.900 seconds
[0m13:27:31.656916 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m13:27:31.657541 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m13:27:31.661433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5290c54a90>]}
[0m13:27:31.662205 [debug] [MainThread]: On master: COMMIT
[0m13:27:31.667971 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_customers
[0m13:27:31.668798 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_customers ............................... [RUN]
[0m13:27:31.669518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now model.dbt_playground.stg_customers)
[0m13:27:31.670190 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_customers
[0m13:27:31.675473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_customers"
[0m13:27:31.676005 [debug] [Thread-2 (]: Began running node model.dbt_playground.stg_events
[0m13:27:31.677002 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_events .................................. [RUN]
[0m13:27:31.677822 [debug] [Thread-2 (]: Acquiring new trino connection 'model.dbt_playground.stg_events'
[0m13:27:31.678353 [debug] [Thread-2 (]: Began compiling node model.dbt_playground.stg_events
[0m13:27:31.687543 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_customers
[0m13:27:31.684599 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m13:27:31.694162 [debug] [Thread-2 (]: Began executing node model.dbt_playground.stg_events
[0m13:27:31.743353 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m13:27:31.744324 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_customers"
[0m13:27:31.746492 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.stg_customers"
[0m13:27:31.747858 [debug] [Thread-2 (]: Using trino connection "model.dbt_playground.stg_events"
[0m13:27:31.748433 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_customers"} */

  create or replace view
    "iceberg"."public"."stg_customers"
  security definer
  as
    select
    id as customer_id,
    name,
    email
from "postgres"."public"."customers"
  
[0m13:27:31.749043 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  create or replace view
    "iceberg"."public"."stg_events"
  security definer
  as
    select
    event_id,
    user_id as customer_id,
    event_type,
    event_time
from "iceberg"."data"."events"
  
[0m13:27:31.749674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:31.750178 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:27:32.673410 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.923 seconds
[0m13:27:32.705994 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: ROLLBACK
[0m13:27:32.706574 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: Close
[0m13:27:32.712038 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5290117c40>]}
[0m13:27:32.714194 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_events ............................. [[32mCREATE VIEW[0m in 1.03s]
[0m13:27:32.716733 [debug] [Thread-2 (]: Finished running node model.dbt_playground.stg_events
[0m13:27:32.794299 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.045 seconds
[0m13:27:32.798958 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: ROLLBACK
[0m13:27:32.799656 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: Close
[0m13:27:32.801244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e529012bfa0>]}
[0m13:27:32.802391 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 1.13s]
[0m13:27:32.803473 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_customers
[0m13:27:32.804767 [debug] [Thread-4 (]: Began running node model.dbt_playground.customer_activity
[0m13:27:32.805708 [info ] [Thread-4 (]: 3 of 3 START sql table model public.customer_activity .......................... [RUN]
[0m13:27:32.806676 [debug] [Thread-4 (]: Acquiring new trino connection 'model.dbt_playground.customer_activity'
[0m13:27:32.807311 [debug] [Thread-4 (]: Began compiling node model.dbt_playground.customer_activity
[0m13:27:32.813197 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_playground.customer_activity"
[0m13:27:32.814473 [debug] [Thread-4 (]: Began executing node model.dbt_playground.customer_activity
[0m13:27:32.880531 [debug] [Thread-4 (]: Applying DROP to: "iceberg"."public"."customer_activity__dbt_backup"
[0m13:27:32.883959 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_activity"
[0m13:27:32.884609 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_activity"} */

    drop table if exists "iceberg"."public"."customer_activity__dbt_backup"
[0m13:27:32.885175 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:27:33.010786 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20260110_132732_00004_7w8ge
[0m13:27:33.011424 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_activity__dbt_backup'", query_id=20260110_132732_00004_7w8ge)
[0m13:27:33.012181 [debug] [Thread-4 (]: On model.dbt_playground.customer_activity: Close
[0m13:27:33.018118 [debug] [Thread-4 (]: Database Error in model customer_activity (models/marts/customer_activity.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_activity__dbt_backup'", query_id=20260110_132732_00004_7w8ge)
[0m13:27:33.019440 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42ebbcf7-da9f-4682-b17a-e99a0299ec7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e52916cff40>]}
[0m13:27:33.020576 [error] [Thread-4 (]: 3 of 3 ERROR creating sql table model public.customer_activity ................. [[31mERROR[0m in 0.21s]
[0m13:27:33.022123 [debug] [Thread-4 (]: Finished running node model.dbt_playground.customer_activity
[0m13:27:33.023087 [debug] [Thread-7 (]: Marking all children of 'model.dbt_playground.customer_activity' to be skipped because of status 'error'.  Reason: Database Error in model customer_activity (models/marts/customer_activity.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_activity__dbt_backup'", query_id=20260110_132732_00004_7w8ge).
[0m13:27:33.026337 [debug] [MainThread]: On master: COMMIT
[0m13:27:33.027300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:33.028142 [debug] [MainThread]: Connection 'model.dbt_playground.stg_customers' was properly closed.
[0m13:27:33.029460 [debug] [MainThread]: Connection 'model.dbt_playground.stg_events' was properly closed.
[0m13:27:33.030008 [debug] [MainThread]: Connection 'model.dbt_playground.customer_activity' was properly closed.
[0m13:27:33.030463 [info ] [MainThread]: 
[0m13:27:33.030889 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m13:27:33.033105 [debug] [MainThread]: Command end result
[0m13:27:33.078181 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:27:33.080567 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:27:33.088919 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:27:33.089435 [info ] [MainThread]: 
[0m13:27:33.092043 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:27:33.092782 [info ] [MainThread]: 
[0m13:27:33.093409 [error] [MainThread]: [31mFailure in model customer_activity (models/marts/customer_activity.sql)[0m
[0m13:27:33.093985 [error] [MainThread]:   Database Error in model customer_activity (models/marts/customer_activity.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_activity__dbt_backup'", query_id=20260110_132732_00004_7w8ge)
[0m13:27:33.094414 [info ] [MainThread]: 
[0m13:27:33.094858 [info ] [MainThread]:   compiled code at target/compiled/dbt_playground/models/marts/customer_activity.sql
[0m13:27:33.095235 [info ] [MainThread]: 
[0m13:27:33.095656 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:27:33.097096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.4950566, "process_in_blocks": "0", "process_kernel_time": 0.420536, "process_mem_max_rss": "117908", "process_out_blocks": "1936", "process_user_time": 3.426137}
[0m13:27:33.097933 [debug] [MainThread]: Command `dbt run` failed at 13:27:33.097728 after 5.50 seconds
[0m13:27:33.098567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e52925442e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5291d2a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e52923fe560>]}
[0m13:27:33.099189 [debug] [MainThread]: Flushing usage events
[0m13:27:34.040515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:30.282861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02e12ec2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02e02b04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02e02b0490>]}


============================== 13:35:30.285958 | 7fb953b1-963a-4690-af47-79f131b38712 ==============================
[0m13:35:30.285958 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:35:30.286659 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'profiles_dir': '/root/.dbt', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'log_path': '/usr/app/dbt_project/logs', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m13:35:30.592396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02e02b0520>]}
[0m13:35:30.719640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02e026b220>]}
[0m13:35:30.720643 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m13:35:30.845618 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:35:31.036475 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:35:31.037142 [debug] [MainThread]: Partial parsing: added file: dbt_playground://models/marts/customer_summary.sql
[0m13:35:31.037495 [debug] [MainThread]: Partial parsing: deleted file: dbt_playground://models/marts/customer_activity.sql
[0m13:35:31.582745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02df9ad630>]}
[0m13:35:31.698941 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:35:31.701346 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:35:31.711277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02dfbfca30>]}
[0m13:35:31.712113 [info ] [MainThread]: Found 3 models, 3 sources, 455 macros
[0m13:35:31.712733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02df9e49d0>]}
[0m13:35:31.715122 [info ] [MainThread]: 
[0m13:35:31.715836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:31.716351 [info ] [MainThread]: 
[0m13:35:31.717060 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:35:31.724890 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:35:31.784568 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:35:31.785105 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m13:35:31.785496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:31.785847 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:35:31.787621 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02df9f5e40>]}
[0m13:35:31.905820 [debug] [ThreadPool]: SQL status: SUCCESS in 0.120 seconds
[0m13:35:31.907378 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:35:31.910058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_public)
[0m13:35:31.930741 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m13:35:31.931288 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m13:35:31.931669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:32.293319 [debug] [ThreadPool]: SQL status: SUCCESS in 0.362 seconds
[0m13:35:32.295291 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m13:35:32.295834 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m13:35:32.297978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02dfc5e410>]}
[0m13:35:32.298644 [debug] [MainThread]: On master: COMMIT
[0m13:35:32.306903 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_customers
[0m13:35:32.308667 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_customers ............................... [RUN]
[0m13:35:32.309837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now model.dbt_playground.stg_customers)
[0m13:35:32.310660 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_customers
[0m13:35:32.319833 [debug] [Thread-2 (]: Began running node model.dbt_playground.stg_events
[0m13:35:32.320604 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_customers"
[0m13:35:32.321517 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_events .................................. [RUN]
[0m13:35:32.324156 [debug] [Thread-2 (]: Acquiring new trino connection 'model.dbt_playground.stg_events'
[0m13:35:32.326548 [debug] [Thread-2 (]: Began compiling node model.dbt_playground.stg_events
[0m13:35:32.323295 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_customers
[0m13:35:32.345312 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m13:35:32.346619 [debug] [Thread-2 (]: Began executing node model.dbt_playground.stg_events
[0m13:35:32.396946 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_customers"
[0m13:35:32.397458 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m13:35:32.399658 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.stg_customers"
[0m13:35:32.401359 [debug] [Thread-2 (]: Using trino connection "model.dbt_playground.stg_events"
[0m13:35:32.401905 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_customers"} */

  create or replace view
    "iceberg"."public"."stg_customers"
  security definer
  as
    select
    id as customer_id,
    name,
    email
from "postgres"."public"."customers"
  
[0m13:35:32.402491 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  create or replace view
    "iceberg"."public"."stg_events"
  security definer
  as
    select
    event_id,
    user_id as customer_id,
    event_type,
    event_time
from "iceberg"."data"."events"
  
[0m13:35:32.403050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:32.403566 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:35:32.680969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.278 seconds
[0m13:35:32.710564 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: ROLLBACK
[0m13:35:32.712510 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: Close
[0m13:35:32.716403 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.313 seconds
[0m13:35:32.717094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02de4ad750>]}
[0m13:35:32.719436 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: ROLLBACK
[0m13:35:32.720327 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.40s]
[0m13:35:32.720988 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: Close
[0m13:35:32.721861 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_customers
[0m13:35:32.723048 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02de4c9a50>]}
[0m13:35:32.725197 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_events ............................. [[32mCREATE VIEW[0m in 0.40s]
[0m13:35:32.725939 [debug] [Thread-2 (]: Finished running node model.dbt_playground.stg_events
[0m13:35:32.727384 [debug] [Thread-4 (]: Began running node model.dbt_playground.customer_summary
[0m13:35:32.728153 [info ] [Thread-4 (]: 3 of 3 START sql table model public.customer_summary ........................... [RUN]
[0m13:35:32.728882 [debug] [Thread-4 (]: Acquiring new trino connection 'model.dbt_playground.customer_summary'
[0m13:35:32.729379 [debug] [Thread-4 (]: Began compiling node model.dbt_playground.customer_summary
[0m13:35:32.733573 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_playground.customer_summary"
[0m13:35:32.734368 [debug] [Thread-4 (]: Began executing node model.dbt_playground.customer_summary
[0m13:35:32.797164 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_playground.customer_summary"
[0m13:35:32.799708 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_summary"
[0m13:35:32.800384 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_summary"} */

  
    

    create table "iceberg"."public"."customer_summary"
      
      
    as (
      with customers as (
    select * from "iceberg"."public"."stg_customers"
),
events as (
    select * from "iceberg"."public"."stg_events"
)
select
    c.customer_id,
    c.name,
    count(e.event_id) as total_events
from customers c
left join events e on c.customer_id = e.customer_id
group by 1, 2
    )
[0m13:35:32.800842 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:35:36.588306 [debug] [Thread-4 (]: SQL status: CREATE TABLE (3 rows) in 3.787 seconds
[0m13:35:36.590681 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: ROLLBACK
[0m13:35:36.591185 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: Close
[0m13:35:36.592849 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fb953b1-963a-4690-af47-79f131b38712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02dc34bee0>]}
[0m13:35:36.593805 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.customer_summary ...................... [[32mCREATE TABLE (3 rows)[0m in 3.86s]
[0m13:35:36.594836 [debug] [Thread-4 (]: Finished running node model.dbt_playground.customer_summary
[0m13:35:36.597330 [debug] [MainThread]: On master: COMMIT
[0m13:35:36.598198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:36.598693 [debug] [MainThread]: Connection 'model.dbt_playground.stg_customers' was properly closed.
[0m13:35:36.599092 [debug] [MainThread]: Connection 'model.dbt_playground.stg_events' was properly closed.
[0m13:35:36.599472 [debug] [MainThread]: Connection 'model.dbt_playground.customer_summary' was properly closed.
[0m13:35:36.600083 [info ] [MainThread]: 
[0m13:35:36.601350 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m13:35:36.603937 [debug] [MainThread]: Command end result
[0m13:35:36.633988 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:35:36.636336 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:35:36.645474 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:35:36.646070 [info ] [MainThread]: 
[0m13:35:36.646639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:36.647091 [info ] [MainThread]: 
[0m13:35:36.647531 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:35:36.648925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.469803, "process_in_blocks": "0", "process_kernel_time": 0.50358, "process_mem_max_rss": "122280", "process_out_blocks": "2840", "process_user_time": 3.449124}
[0m13:35:36.649580 [debug] [MainThread]: Command `dbt run` succeeded at 13:35:36.649456 after 6.47 seconds
[0m13:35:36.650003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02e12ec2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02e01d6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e02e137b520>]}
[0m13:35:36.650445 [debug] [MainThread]: Flushing usage events
[0m13:35:37.540878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:05.822142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4654d54550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4653d08790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4653d08730>]}


============================== 14:33:05.827305 | 16873aca-d091-4e26-9f92-85928864acbf ==============================
[0m14:33:05.827305 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:33:05.827792 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'invocation_command': 'dbt debug', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m14:33:05.835057 [info ] [MainThread]: dbt version: 1.11.2
[0m14:33:05.835512 [info ] [MainThread]: python version: 3.10.19
[0m14:33:05.835829 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m14:33:05.836195 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m14:33:05.905938 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m14:33:05.906465 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:33:05.906800 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m14:33:05.907234 [info ] [MainThread]: adapter type: trino
[0m14:33:05.907554 [info ] [MainThread]: adapter version: 1.10.0
[0m14:33:06.056169 [info ] [MainThread]: Configuration:
[0m14:33:06.056654 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:33:06.056976 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:33:06.057348 [info ] [MainThread]: Required dependencies:
[0m14:33:06.057721 [debug] [MainThread]: Executing "git --help"
[0m14:33:06.059651 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:33:06.060009 [debug] [MainThread]: STDERR: "b''"
[0m14:33:06.060308 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:33:06.060625 [info ] [MainThread]: Connection:
[0m14:33:06.060971 [info ] [MainThread]:   host: trino
[0m14:33:06.061343 [info ] [MainThread]:   port: 8080
[0m14:33:06.061650 [info ] [MainThread]:   user: admin
[0m14:33:06.061995 [info ] [MainThread]:   database: iceberg
[0m14:33:06.062344 [info ] [MainThread]:   schema: public
[0m14:33:06.062652 [info ] [MainThread]:   cert: None
[0m14:33:06.062999 [info ] [MainThread]:   prepared_statements_enabled: True
[0m14:33:06.063511 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m14:33:06.138805 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m14:33:06.170274 [debug] [MainThread]: Using trino connection "debug"
[0m14:33:06.170731 [debug] [MainThread]: On debug: select 1 as id
[0m14:33:06.171034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:06.171321 [warn ] [MainThread]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:33:06.171821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '16873aca-d091-4e26-9f92-85928864acbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465388a170>]}
[0m14:33:06.242816 [debug] [MainThread]: SQL status: SUCCESS in 0.072 seconds
[0m14:33:06.243897 [debug] [MainThread]: On debug: Close
[0m14:33:06.244374 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:33:06.244837 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:33:06.246058 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.50874966, "process_in_blocks": "32", "process_kernel_time": 0.1887, "process_mem_max_rss": "108228", "process_out_blocks": "984", "process_user_time": 1.728099}
[0m14:33:06.246510 [debug] [MainThread]: Command `dbt debug` succeeded at 14:33:06.246411 after 0.51 seconds
[0m14:33:06.246828 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:33:06.247156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4654d54550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4653cc0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46564e19c0>]}
[0m14:33:06.247623 [debug] [MainThread]: Flushing usage events
[0m14:33:07.228466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:54.501670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de8fa4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de7f68400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de7f683a0>]}


============================== 14:34:54.504195 | a08329b3-80e9-40aa-b4e2-4913ea909059 ==============================
[0m14:34:54.504195 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:34:54.504690 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'invocation_command': 'dbt deps', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None'}
[0m14:34:54.507020 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at `dbt_playground.materialized` in
file `/usr/app/dbt_project/dbt_project.yml`. Hierarchical config values without
a '+' prefix are deprecated in dbt_project.yml.
[0m14:34:54.507410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a08329b3-80e9-40aa-b4e2-4913ea909059', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de7f68b80>]}
[0m14:34:54.668853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a08329b3-80e9-40aa-b4e2-4913ea909059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8deac39030>]}
[0m14:34:54.678835 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:34:54.680031 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:34:54.680618 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:34:54.681474 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2596006, "process_in_blocks": "0", "process_kernel_time": 0.100558, "process_mem_max_rss": "100168", "process_out_blocks": "16", "process_user_time": 1.548594}
[0m14:34:54.681945 [debug] [MainThread]: Command `dbt deps` succeeded at 14:34:54.681793 after 0.26 seconds
[0m14:34:54.682291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de8fa4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8deac39030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de7ea4d60>]}
[0m14:34:54.682634 [debug] [MainThread]: Flushing usage events
[0m14:34:55.676508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:57.464540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a02c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78fec4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78fec460>]}


============================== 14:34:57.466856 | 5026f2ce-f32f-4e7f-ab94-607fd618ec69 ==============================
[0m14:34:57.466856 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:34:57.467346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'empty': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'log_path': '/usr/app/dbt_project/logs', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m14:34:57.676663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae79ee5690>]}
[0m14:34:57.761203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78fa63b0>]}
[0m14:34:57.761913 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m14:34:57.840905 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:34:57.983896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:57.984358 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:34:57.984637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:58.033607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78816080>]}
[0m14:34:58.203793 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:34:58.205838 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:34:58.213022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78c67160>]}
[0m14:34:58.213532 [info ] [MainThread]: Found 3 models, 3 sources, 455 macros
[0m14:34:58.213882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78c65ae0>]}
[0m14:34:58.215700 [info ] [MainThread]: 
[0m14:34:58.216060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:34:58.216364 [info ] [MainThread]: 
[0m14:34:58.216998 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:34:58.222419 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:34:58.278971 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:34:58.279492 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:34:58.279957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:58.280397 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:34:58.280877 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae787f8a00>]}
[0m14:34:58.422295 [debug] [ThreadPool]: SQL status: SUCCESS in 0.142 seconds
[0m14:34:58.424606 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:34:58.426356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_public)
[0m14:34:58.427300 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "public"
"
[0m14:34:58.433880 [debug] [ThreadPool]: Using trino connection "create_iceberg_public"
[0m14:34:58.434409 [debug] [ThreadPool]: On create_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_iceberg_public"} */
create schema if not exists "iceberg"."public"
[0m14:34:58.434748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:58.482625 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.048 seconds
[0m14:34:58.483803 [debug] [ThreadPool]: On create_iceberg_public: COMMIT
[0m14:34:58.484157 [debug] [ThreadPool]: On create_iceberg_public: Close
[0m14:34:58.485790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_public, now list_iceberg_public)
[0m14:34:58.503833 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m14:34:58.504290 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m14:34:58.504573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:58.921030 [debug] [ThreadPool]: SQL status: SUCCESS in 0.416 seconds
[0m14:34:58.922511 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m14:34:58.922880 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m14:34:58.923671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae787f6fb0>]}
[0m14:34:58.924122 [debug] [MainThread]: On master: COMMIT
[0m14:34:58.929691 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_customers
[0m14:34:58.930330 [debug] [Thread-2 (]: Began running node model.dbt_playground.stg_events
[0m14:34:58.931202 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_customers ............................... [RUN]
[0m14:34:58.932087 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_events .................................. [RUN]
[0m14:34:58.932850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now model.dbt_playground.stg_customers)
[0m14:34:58.933596 [debug] [Thread-2 (]: Acquiring new trino connection 'model.dbt_playground.stg_events'
[0m14:34:58.934144 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_customers
[0m14:34:58.934648 [debug] [Thread-2 (]: Began compiling node model.dbt_playground.stg_events
[0m14:34:58.940470 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_customers"
[0m14:34:58.944874 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m14:34:58.945876 [debug] [Thread-2 (]: Began executing node model.dbt_playground.stg_events
[0m14:34:58.969979 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m14:34:58.970560 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_customers
[0m14:34:58.973904 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_customers"
[0m14:34:58.975461 [debug] [Thread-2 (]: Using trino connection "model.dbt_playground.stg_events"
[0m14:34:58.976524 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.stg_customers"
[0m14:34:58.976891 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  create or replace view
    "iceberg"."public"."stg_events"
  security definer
  as
    select
    event_id,
    user_id as customer_id,
    event_type,
    event_time
from "iceberg"."data"."events"
  
[0m14:34:58.977371 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_customers"} */

  create or replace view
    "iceberg"."public"."stg_customers"
  security definer
  as
    select
    id as customer_id,
    name,
    email
from "postgres"."public"."customers"
  
[0m14:34:58.977799 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:34:58.978209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:59.341965 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.364 seconds
[0m14:34:59.364182 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: ROLLBACK
[0m14:34:59.364824 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: Close
[0m14:34:59.367508 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a46caf0>]}
[0m14:34:59.368455 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_events ............................. [[32mCREATE VIEW[0m in 0.43s]
[0m14:34:59.369255 [debug] [Thread-2 (]: Finished running node model.dbt_playground.stg_events
[0m14:34:59.402425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.424 seconds
[0m14:34:59.404680 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: ROLLBACK
[0m14:34:59.405089 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: Close
[0m14:34:59.405807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b129b0>]}
[0m14:34:59.406405 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.47s]
[0m14:34:59.406964 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_customers
[0m14:34:59.408162 [debug] [Thread-4 (]: Began running node model.dbt_playground.customer_summary
[0m14:34:59.408645 [info ] [Thread-4 (]: 3 of 3 START sql table model public.customer_summary ........................... [RUN]
[0m14:34:59.409175 [debug] [Thread-4 (]: Acquiring new trino connection 'model.dbt_playground.customer_summary'
[0m14:34:59.409508 [debug] [Thread-4 (]: Began compiling node model.dbt_playground.customer_summary
[0m14:34:59.414109 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_playground.customer_summary"
[0m14:34:59.414844 [debug] [Thread-4 (]: Began executing node model.dbt_playground.customer_summary
[0m14:34:59.467776 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_playground.customer_summary"
[0m14:34:59.470043 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_summary"
[0m14:34:59.470419 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_summary"} */

  
    

    create table "iceberg"."public"."customer_summary"
      
      
    as (
      with customers as (
    select * from "iceberg"."public"."stg_customers"
),
events as (
    select * from "iceberg"."public"."stg_events"
)
select
    c.customer_id,
    c.name,
    count(e.event_id) as total_events
from customers c
left join events e on c.customer_id = e.customer_id
group by 1, 2
    )
[0m14:34:59.470754 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:35:00.418337 [debug] [Thread-4 (]: SQL status: CREATE TABLE (3 rows) in 0.947 seconds
[0m14:35:00.420424 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: ROLLBACK
[0m14:35:00.420807 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: Close
[0m14:35:00.421550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5026f2ce-f32f-4e7f-ab94-607fd618ec69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae787f8eb0>]}
[0m14:35:00.422247 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.customer_summary ...................... [[32mCREATE TABLE (3 rows)[0m in 1.01s]
[0m14:35:00.422935 [debug] [Thread-4 (]: Finished running node model.dbt_playground.customer_summary
[0m14:35:00.425288 [debug] [MainThread]: On master: COMMIT
[0m14:35:00.425785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:00.426053 [debug] [MainThread]: Connection 'model.dbt_playground.stg_customers' was properly closed.
[0m14:35:00.426312 [debug] [MainThread]: Connection 'model.dbt_playground.stg_events' was properly closed.
[0m14:35:00.426632 [debug] [MainThread]: Connection 'model.dbt_playground.customer_summary' was properly closed.
[0m14:35:00.427028 [info ] [MainThread]: 
[0m14:35:00.427388 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m14:35:00.428555 [debug] [MainThread]: Command end result
[0m14:35:00.456826 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:35:00.458580 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:35:00.465537 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:35:00.465964 [info ] [MainThread]: 
[0m14:35:00.466374 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:00.466742 [info ] [MainThread]: 
[0m14:35:00.467148 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:35:00.468087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.080886, "process_in_blocks": "928", "process_kernel_time": 0.100433, "process_mem_max_rss": "119008", "process_out_blocks": "1960", "process_user_time": 2.480696}
[0m14:35:00.468517 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:00.468418 after 3.08 seconds
[0m14:35:00.469152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a02c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78f668c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae79ee5690>]}
[0m14:35:00.469544 [debug] [MainThread]: Flushing usage events
[0m14:35:01.404994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:52:00.457014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1db245b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1cb00820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1cb007c0>]}


============================== 14:52:00.462568 | b0941e93-7df4-4fd8-8496-cde3f06b8ab2 ==============================
[0m14:52:00.462568 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:52:00.463069 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/usr/app/dbt_project/logs', 'no_print': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt seed --target dev --select iceberg', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'empty': 'None', 'quiet': 'False'}
[0m14:52:00.691469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0941e93-7df4-4fd8-8496-cde3f06b8ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1f7c6b60>]}
[0m14:52:00.779208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0941e93-7df4-4fd8-8496-cde3f06b8ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1d309d50>]}
[0m14:52:00.779848 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m14:52:00.880033 [debug] [MainThread]: checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0, vars: {}, profile: , target: dev, version: 1.11.2
[0m14:52:00.996907 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:52:00.997355 [debug] [MainThread]: previous checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0, current checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b
[0m14:52:00.997624 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:52:00.997977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0941e93-7df4-4fd8-8496-cde3f06b8ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1d309ea0>]}
[0m14:52:02.681736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0941e93-7df4-4fd8-8496-cde3f06b8ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1a100880>]}
[0m14:52:02.783100 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:52:02.784897 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:52:02.796101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0941e93-7df4-4fd8-8496-cde3f06b8ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1ca2a9b0>]}
[0m14:52:02.796592 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 455 macros
[0m14:52:02.796936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0941e93-7df4-4fd8-8496-cde3f06b8ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1ca2a890>]}
[0m14:52:02.798181 [info ] [MainThread]: 
[0m14:52:02.798810 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:02.799138 [info ] [MainThread]: 
[0m14:52:02.799686 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:52:02.800817 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:52:02.846195 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:52:02.846622 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:52:02.846914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:02.847169 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:52:02.847619 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'b0941e93-7df4-4fd8-8496-cde3f06b8ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f19e78370>]}
[0m14:52:02.904422 [debug] [ThreadPool]: SQL status: SUCCESS in 0.057 seconds
[0m14:52:02.905860 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:52:02.906667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_public_data)
[0m14:52:02.907095 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "public_data"
"
[0m14:52:02.912164 [debug] [ThreadPool]: Using trino connection "create_iceberg_public_data"
[0m14:52:02.912520 [debug] [ThreadPool]: On create_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_iceberg_public_data"} */
create schema if not exists "iceberg"."public_data"
[0m14:52:02.912796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:02.948673 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.036 seconds
[0m14:52:02.949732 [debug] [ThreadPool]: On create_iceberg_public_data: COMMIT
[0m14:52:02.950080 [debug] [ThreadPool]: On create_iceberg_public_data: Close
[0m14:52:02.956877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_public_data, now list_iceberg_public)
[0m14:52:02.957717 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public_data'
[0m14:52:02.963921 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public_public'
[0m14:52:02.982600 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_data"
[0m14:52:02.977854 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m14:52:02.988259 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_public"
[0m14:52:02.988723 [debug] [ThreadPool]: On list_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_data"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_data') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_data'
[0m14:52:02.989180 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m14:52:02.989614 [debug] [ThreadPool]: On list_iceberg_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_public'
[0m14:52:02.990000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:02.990356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:02.990686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:03.204801 [debug] [ThreadPool]: SQL status: SUCCESS in 0.214 seconds
[0m14:52:03.207142 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m14:52:03.207771 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m14:52:03.225511 [debug] [ThreadPool]: SQL status: SUCCESS in 0.235 seconds
[0m14:52:03.227862 [debug] [ThreadPool]: On list_iceberg_public_public: ROLLBACK
[0m14:52:03.229366 [debug] [ThreadPool]: On list_iceberg_public_public: Close
[0m14:52:03.236561 [debug] [ThreadPool]: SQL status: SUCCESS in 0.246 seconds
[0m14:52:03.238135 [debug] [ThreadPool]: On list_iceberg_public_data: ROLLBACK
[0m14:52:03.238586 [debug] [ThreadPool]: On list_iceberg_public_data: Close
[0m14:52:03.239586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0941e93-7df4-4fd8-8496-cde3f06b8ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1f9e4130>]}
[0m14:52:03.240112 [debug] [MainThread]: On master: COMMIT
[0m14:52:03.246871 [debug] [Thread-1 (]: Began running node seed.dbt_playground.events
[0m14:52:03.247509 [info ] [Thread-1 (]: 1 of 1 START seed file public_data.events ...................................... [RUN]
[0m14:52:03.247989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public_data, now seed.dbt_playground.events)
[0m14:52:03.248337 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.events
[0m14:52:03.248714 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.events
[0m14:52:03.302295 [debug] [Thread-1 (]: Using trino connection "seed.dbt_playground.events"
[0m14:52:03.302818 [debug] [Thread-1 (]: On seed.dbt_playground.events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "seed.dbt_playground.events"} */

    create table "iceberg"."public_data"."events" ("event_id" VARCHAR,"user_id" INTEGER,"event_type" VARCHAR,"event_time" TIMESTAMP)
[0m14:52:03.303174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:03.440709 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.137 seconds
[0m14:52:03.474858 [debug] [Thread-1 (]: Using trino connection "seed.dbt_playground.events"
[0m14:52:03.475300 [debug] [Thread-1 (]: On seed.dbt_playground.events: insert into "iceberg"."public_data"."events" ("event_id", "user_id", "event_type", "event_time") values
          (?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?)...
[0m14:52:03.828460 [debug] [Thread-1 (]: SQL status: INSERT (4 rows) in 0.353 seconds
[0m14:52:03.835349 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_playground.events"
[0m14:52:03.857755 [debug] [Thread-1 (]: On seed.dbt_playground.events: COMMIT
[0m14:52:03.860005 [debug] [Thread-1 (]: On seed.dbt_playground.events: Close
[0m14:52:03.861993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0941e93-7df4-4fd8-8496-cde3f06b8ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1c2090c0>]}
[0m14:52:03.862602 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_data.events .................................. [[32mINSERT 4[0m in 0.61s]
[0m14:52:03.863286 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.events
[0m14:52:03.865130 [debug] [MainThread]: On master: COMMIT
[0m14:52:03.865510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:03.865760 [debug] [MainThread]: Connection 'list_iceberg_public' was properly closed.
[0m14:52:03.866001 [debug] [MainThread]: Connection 'seed.dbt_playground.events' was properly closed.
[0m14:52:03.866244 [debug] [MainThread]: Connection 'list_iceberg_public_public' was properly closed.
[0m14:52:03.866528 [info ] [MainThread]: 
[0m14:52:03.866856 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m14:52:03.867539 [debug] [MainThread]: Command end result
[0m14:52:03.894921 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:52:03.896580 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:52:03.903407 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:52:03.903759 [info ] [MainThread]: 
[0m14:52:03.904157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:03.904534 [info ] [MainThread]: 
[0m14:52:03.904946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:52:03.906627 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.5336502, "process_in_blocks": "4472", "process_kernel_time": 0.319595, "process_mem_max_rss": "128496", "process_out_blocks": "4376", "process_user_time": 4.014919}
[0m14:52:03.907137 [debug] [MainThread]: Command `dbt seed` succeeded at 14:52:03.907023 after 3.53 seconds
[0m14:52:03.907536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1db245b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1dbc1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1f6539a0>]}
[0m14:52:03.907938 [debug] [MainThread]: Flushing usage events
[0m14:52:04.904381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:52:09.407228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2be202e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2adcc580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2adcc520>]}


============================== 14:52:09.409770 | 73c9d4db-29e9-4894-a6ce-9423932373df ==============================
[0m14:52:09.409770 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:52:09.410298 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt seed --target shop --select shop', 'use_experimental_parser': 'False', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False', 'empty': 'None', 'partial_parse': 'True'}
[0m14:52:09.621098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73c9d4db-29e9-4894-a6ce-9423932373df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e29d46b60>]}
[0m14:52:09.712025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73c9d4db-29e9-4894-a6ce-9423932373df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2ad8e8c0>]}
[0m14:52:09.712827 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:52:09.795050 [debug] [MainThread]: checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, vars: {}, profile: , target: shop, version: 1.11.2
[0m14:52:09.924251 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:52:09.924751 [debug] [MainThread]: previous checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, current checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0
[0m14:52:09.925035 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:52:09.925414 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:52:09.925774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73c9d4db-29e9-4894-a6ce-9423932373df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2b60ab30>]}
[0m14:52:11.492753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73c9d4db-29e9-4894-a6ce-9423932373df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e22376c50>]}
[0m14:52:11.594525 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:52:11.596256 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:52:11.606679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73c9d4db-29e9-4894-a6ce-9423932373df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e28939900>]}
[0m14:52:11.607230 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 434 macros
[0m14:52:11.607581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73c9d4db-29e9-4894-a6ce-9423932373df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e281b1db0>]}
[0m14:52:11.608988 [info ] [MainThread]: 
[0m14:52:11.609335 [info ] [MainThread]: Concurrency: 4 threads (target='shop')
[0m14:52:11.609733 [info ] [MainThread]: 
[0m14:52:11.610436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:11.615172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop'
[0m14:52:11.649582 [debug] [ThreadPool]: Using postgres connection "list_shop"
[0m14:52:11.649998 [debug] [ThreadPool]: On list_shop: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop"} */

    select distinct nspname from pg_namespace
  
[0m14:52:11.650276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:11.666678 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m14:52:11.668052 [debug] [ThreadPool]: On list_shop: Close
[0m14:52:11.668865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_shop, now create_shop_public_public)
[0m14:52:11.669295 [debug] [ThreadPool]: Creating schema "database: "shop"
schema: "public_public"
"
[0m14:52:11.675020 [debug] [ThreadPool]: Using postgres connection "create_shop_public_public"
[0m14:52:11.675420 [debug] [ThreadPool]: On create_shop_public_public: BEGIN
[0m14:52:11.675690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:11.682507 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:52:11.682943 [debug] [ThreadPool]: Using postgres connection "create_shop_public_public"
[0m14:52:11.683225 [debug] [ThreadPool]: On create_shop_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "create_shop_public_public"} */
create schema if not exists "public_public"
[0m14:52:11.685032 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m14:52:11.685975 [debug] [ThreadPool]: On create_shop_public_public: COMMIT
[0m14:52:11.686273 [debug] [ThreadPool]: Using postgres connection "create_shop_public_public"
[0m14:52:11.686548 [debug] [ThreadPool]: On create_shop_public_public: COMMIT
[0m14:52:11.687571 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:52:11.687859 [debug] [ThreadPool]: On create_shop_public_public: Close
[0m14:52:11.689477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_shop_public_public, now list_shop_public_public)
[0m14:52:11.690156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop_public'
[0m14:52:11.696140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop_public_data'
[0m14:52:11.698108 [debug] [ThreadPool]: Using postgres connection "list_shop_public_public"
[0m14:52:11.700810 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m14:52:11.702871 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m14:52:11.703411 [debug] [ThreadPool]: On list_shop_public_public: BEGIN
[0m14:52:11.703812 [debug] [ThreadPool]: On list_shop_public: BEGIN
[0m14:52:11.704165 [debug] [ThreadPool]: On list_shop_public_data: BEGIN
[0m14:52:11.704504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:11.704838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:11.705278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:11.714232 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:52:11.714656 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:52:11.714997 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:52:11.715289 [debug] [ThreadPool]: Using postgres connection "list_shop_public_public"
[0m14:52:11.715717 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m14:52:11.716091 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m14:52:11.716461 [debug] [ThreadPool]: On list_shop_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public_public"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:52:11.716843 [debug] [ThreadPool]: On list_shop_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public_data"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_data'
  
[0m14:52:11.717295 [debug] [ThreadPool]: On list_shop_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:11.723910 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:52:11.724330 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:52:11.724665 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m14:52:11.725846 [debug] [ThreadPool]: On list_shop_public_data: ROLLBACK
[0m14:52:11.726887 [debug] [ThreadPool]: On list_shop_public_public: ROLLBACK
[0m14:52:11.728070 [debug] [ThreadPool]: On list_shop_public: ROLLBACK
[0m14:52:11.728738 [debug] [ThreadPool]: On list_shop_public_data: Close
[0m14:52:11.729120 [debug] [ThreadPool]: On list_shop_public: Close
[0m14:52:11.729508 [debug] [ThreadPool]: On list_shop_public_public: Close
[0m14:52:11.736213 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.736646 [debug] [MainThread]: On master: BEGIN
[0m14:52:11.736916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:11.743563 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:52:11.743999 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.744337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:52:11.749016 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m14:52:11.750309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73c9d4db-29e9-4894-a6ce-9423932373df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e28dcd0c0>]}
[0m14:52:11.750779 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:11.751287 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.751573 [debug] [MainThread]: On master: BEGIN
[0m14:52:11.752141 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:52:11.752418 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.752701 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.752967 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.753356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:11.753696 [debug] [MainThread]: On master: Close
[0m14:52:11.757720 [debug] [Thread-1 (]: Began running node seed.dbt_playground.customers
[0m14:52:11.758257 [debug] [Thread-2 (]: Began running node seed.dbt_playground.products
[0m14:52:11.758740 [info ] [Thread-1 (]: 1 of 2 START seed file public_public.customers ................................. [RUN]
[0m14:52:11.759339 [info ] [Thread-2 (]: 2 of 2 START seed file public_public.products .................................. [RUN]
[0m14:52:11.760030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_shop_public_public, now seed.dbt_playground.customers)
[0m14:52:11.760590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_shop_public, now seed.dbt_playground.products)
[0m14:52:11.761038 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.customers
[0m14:52:11.761475 [debug] [Thread-2 (]: Began compiling node seed.dbt_playground.products
[0m14:52:11.761884 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.customers
[0m14:52:11.762297 [debug] [Thread-2 (]: Began executing node seed.dbt_playground.products
[0m14:52:11.804861 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m14:52:11.805703 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m14:52:11.806058 [debug] [Thread-1 (]: On seed.dbt_playground.customers: BEGIN
[0m14:52:11.806463 [debug] [Thread-2 (]: On seed.dbt_playground.products: BEGIN
[0m14:52:11.806857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:11.807244 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:11.815463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:52:11.816050 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m14:52:11.816407 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m14:52:11.816787 [debug] [Thread-1 (]: On seed.dbt_playground.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.customers"} */

    create table "shop"."public_public"."customers" ("id" integer,"name" text,"email" text,"signup_date" date)
  
[0m14:52:11.817187 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m14:52:11.817704 [debug] [Thread-2 (]: On seed.dbt_playground.products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.products"} */

    create table "shop"."public_public"."products" ("id" integer,"name" text,"price" float8)
  
[0m14:52:11.826451 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.008 seconds
[0m14:52:11.827187 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.010 seconds
[0m14:52:11.847388 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m14:52:11.849542 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m14:52:11.850092 [debug] [Thread-2 (]: On seed.dbt_playground.products: 
          insert into "shop"."public_public"."products" ("id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m14:52:11.850603 [debug] [Thread-1 (]: On seed.dbt_playground.customers: 
          insert into "shop"."public_public"."customers" ("id", "name", "email", "signup_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:52:11.851711 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.000 seconds
[0m14:52:11.852101 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m14:52:11.858031 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_playground.customers"
[0m14:52:11.858789 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_playground.products"
[0m14:52:11.890602 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m14:52:11.892592 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m14:52:11.893076 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m14:52:11.893620 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m14:52:11.894140 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m14:52:11.894605 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m14:52:11.896138 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:52:11.898269 [debug] [Thread-2 (]: On seed.dbt_playground.products: Close
[0m14:52:11.898715 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:52:11.899611 [debug] [Thread-1 (]: On seed.dbt_playground.customers: Close
[0m14:52:11.901420 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c9d4db-29e9-4894-a6ce-9423932373df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2c271d50>]}
[0m14:52:11.901929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c9d4db-29e9-4894-a6ce-9423932373df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2893a7a0>]}
[0m14:52:11.902462 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public_public.products .............................. [[32mINSERT 3[0m in 0.14s]
[0m14:52:11.903221 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public_public.customers ............................. [[32mINSERT 3[0m in 0.14s]
[0m14:52:11.903986 [debug] [Thread-2 (]: Finished running node seed.dbt_playground.products
[0m14:52:11.904671 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.customers
[0m14:52:11.906618 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.907012 [debug] [MainThread]: On master: BEGIN
[0m14:52:11.907284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:11.914097 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:52:11.914568 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.914861 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.915137 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.915584 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:11.915881 [debug] [MainThread]: On master: Close
[0m14:52:11.916355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:11.916620 [debug] [MainThread]: Connection 'seed.dbt_playground.customers' was properly closed.
[0m14:52:11.916872 [debug] [MainThread]: Connection 'seed.dbt_playground.products' was properly closed.
[0m14:52:11.917160 [debug] [MainThread]: Connection 'list_shop_public_data' was properly closed.
[0m14:52:11.917505 [info ] [MainThread]: 
[0m14:52:11.917853 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:52:11.918689 [debug] [MainThread]: Command end result
[0m14:52:11.945273 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:52:11.947483 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:52:11.954316 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:52:11.954668 [info ] [MainThread]: 
[0m14:52:11.955071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:11.955433 [info ] [MainThread]: 
[0m14:52:11.955821 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:52:11.956686 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.6295288, "process_in_blocks": "152", "process_kernel_time": 0.169414, "process_mem_max_rss": "139180", "process_out_blocks": "2640", "process_user_time": 3.846702}
[0m14:52:11.957089 [debug] [MainThread]: Command `dbt seed` succeeded at 14:52:11.956996 after 2.63 seconds
[0m14:52:11.957418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2be202e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2ad8e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e289024a0>]}
[0m14:52:11.957778 [debug] [MainThread]: Flushing usage events
[0m14:52:12.843003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:42.844142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded5d642b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4d1c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4d1c4f0>]}


============================== 14:55:42.846662 | 63dd5e9c-e2dc-46c3-a676-5f7242e8711b ==============================
[0m14:55:42.846662 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:55:42.847154 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'invocation_command': 'dbt seed --target dev --select iceberg', 'no_print': 'None', 'quiet': 'False', 'log_path': '/usr/app/dbt_project/logs', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'empty': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'target_path': 'None', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager'}
[0m14:55:43.072213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63dd5e9c-e2dc-46c3-a676-5f7242e8711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4c67820>]}
[0m14:55:43.162730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63dd5e9c-e2dc-46c3-a676-5f7242e8711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4eef760>]}
[0m14:55:43.163625 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m14:55:43.247734 [debug] [MainThread]: checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0, vars: {}, profile: , target: dev, version: 1.11.2
[0m14:55:43.374091 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:55:43.374599 [debug] [MainThread]: previous checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0, current checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900
[0m14:55:43.374872 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:55:43.375188 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:55:43.375562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63dd5e9c-e2dc-46c3-a676-5f7242e8711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded554eb30>]}
[0m14:55:45.014601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63dd5e9c-e2dc-46c3-a676-5f7242e8711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded2199870>]}
[0m14:55:45.120511 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:55:45.122565 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:55:45.131463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63dd5e9c-e2dc-46c3-a676-5f7242e8711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded44e2440>]}
[0m14:55:45.132009 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 455 macros
[0m14:55:45.132370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63dd5e9c-e2dc-46c3-a676-5f7242e8711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded44ba2c0>]}
[0m14:55:45.133732 [info ] [MainThread]: 
[0m14:55:45.134111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:45.134436 [info ] [MainThread]: 
[0m14:55:45.135156 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:55:45.136352 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m14:55:45.180680 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m14:55:45.181119 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m14:55:45.181400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:45.181653 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:55:45.182110 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '63dd5e9c-e2dc-46c3-a676-5f7242e8711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded21d2fe0>]}
[0m14:55:45.229441 [debug] [ThreadPool]: SQL status: SUCCESS in 0.048 seconds
[0m14:55:45.230873 [debug] [ThreadPool]: On list_iceberg: Close
[0m14:55:45.237172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_public_data)
[0m14:55:45.243098 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public'
[0m14:55:45.244124 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public_public'
[0m14:55:45.256911 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_data"
[0m14:55:45.261879 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m14:55:45.266751 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_public"
[0m14:55:45.267195 [debug] [ThreadPool]: On list_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_data"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_data') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_data'
[0m14:55:45.267640 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m14:55:45.268058 [debug] [ThreadPool]: On list_iceberg_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_public'
[0m14:55:45.268435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:45.268789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:45.269146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:45.470629 [debug] [ThreadPool]: SQL status: SUCCESS in 0.201 seconds
[0m14:55:45.472794 [debug] [ThreadPool]: On list_iceberg_public_public: ROLLBACK
[0m14:55:45.473368 [debug] [ThreadPool]: On list_iceberg_public_public: Close
[0m14:55:45.474250 [debug] [ThreadPool]: SQL status: SUCCESS in 0.205 seconds
[0m14:55:45.477805 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m14:55:45.478852 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m14:55:45.479423 [debug] [ThreadPool]: SQL status: SUCCESS in 0.211 seconds
[0m14:55:45.481700 [debug] [ThreadPool]: On list_iceberg_public_data: ROLLBACK
[0m14:55:45.481993 [debug] [ThreadPool]: On list_iceberg_public_data: Close
[0m14:55:45.483426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63dd5e9c-e2dc-46c3-a676-5f7242e8711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded7a5bd90>]}
[0m14:55:45.484128 [debug] [MainThread]: On master: COMMIT
[0m14:55:45.487514 [debug] [Thread-1 (]: Began running node seed.dbt_playground.events
[0m14:55:45.488187 [info ] [Thread-1 (]: 1 of 1 START seed file public_data.events ...................................... [RUN]
[0m14:55:45.488737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public_data, now seed.dbt_playground.events)
[0m14:55:45.489132 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.events
[0m14:55:45.489525 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.events
[0m14:55:45.522482 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."public_data"."events"
[0m14:55:45.524694 [debug] [Thread-1 (]: Using trino connection "seed.dbt_playground.events"
[0m14:55:45.525060 [debug] [Thread-1 (]: On seed.dbt_playground.events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "seed.dbt_playground.events"} */

    drop table if exists "iceberg"."public_data"."events"
[0m14:55:45.525391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:45.594684 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20260111_145547_00024_vv9a2
[0m14:55:45.595171 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'events'", query_id=20260111_145547_00024_vv9a2)
[0m14:55:45.595670 [debug] [Thread-1 (]: On seed.dbt_playground.events: Close
[0m14:55:45.598709 [debug] [Thread-1 (]: Database Error in seed events (seeds/iceberg/events.csv)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'events'", query_id=20260111_145547_00024_vv9a2)
[0m14:55:45.600612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63dd5e9c-e2dc-46c3-a676-5f7242e8711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded2198f40>]}
[0m14:55:45.601153 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public_data.events .............................. [[31mERROR[0m in 0.11s]
[0m14:55:45.601784 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.events
[0m14:55:45.602365 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_playground.events' to be skipped because of status 'error'.  Reason: Database Error in seed events (seeds/iceberg/events.csv)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'events'", query_id=20260111_145547_00024_vv9a2).
[0m14:55:45.604657 [debug] [MainThread]: On master: COMMIT
[0m14:55:45.605120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:45.605387 [debug] [MainThread]: Connection 'seed.dbt_playground.events' was properly closed.
[0m14:55:45.605643 [debug] [MainThread]: Connection 'list_iceberg_public' was properly closed.
[0m14:55:45.605929 [debug] [MainThread]: Connection 'list_iceberg_public_public' was properly closed.
[0m14:55:45.606226 [info ] [MainThread]: 
[0m14:55:45.606589 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m14:55:45.607296 [debug] [MainThread]: Command end result
[0m14:55:45.634646 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:55:45.636379 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:55:45.642927 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:55:45.643231 [info ] [MainThread]: 
[0m14:55:45.643672 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:55:45.644031 [info ] [MainThread]: 
[0m14:55:45.644533 [error] [MainThread]: [31mFailure in seed events (seeds/iceberg/events.csv)[0m
[0m14:55:45.645021 [error] [MainThread]:   Database Error in seed events (seeds/iceberg/events.csv)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'events'", query_id=20260111_145547_00024_vv9a2)
[0m14:55:45.645357 [info ] [MainThread]: 
[0m14:55:45.645717 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:55:45.646647 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.8852246, "process_in_blocks": "0", "process_kernel_time": 0.219196, "process_mem_max_rss": "128720", "process_out_blocks": "2816", "process_user_time": 3.786129}
[0m14:55:45.647067 [debug] [MainThread]: Command `dbt seed` failed at 14:55:45.646971 after 2.89 seconds
[0m14:55:45.647422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded5d642b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4c67820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded2279c60>]}
[0m14:55:45.647763 [debug] [MainThread]: Flushing usage events
[0m14:55:46.630557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:01.818935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2225de42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2224d84580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2224d84520>]}


============================== 14:56:01.821550 | a185df74-c3db-44f9-a5ca-55af5b24856e ==============================
[0m14:56:01.821550 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:56:01.822030 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'invocation_command': 'dbt seed --target shop --select shop', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/root/.dbt', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'log_format': 'default', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/app/dbt_project/logs'}
[0m14:56:02.026422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a185df74-c3db-44f9-a5ca-55af5b24856e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2223d52b60>]}
[0m14:56:02.115127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a185df74-c3db-44f9-a5ca-55af5b24856e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2224d3e8c0>]}
[0m14:56:02.115933 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:56:02.209026 [debug] [MainThread]: checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, vars: {}, profile: , target: shop, version: 1.11.2
[0m14:56:02.334337 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:56:02.334789 [debug] [MainThread]: previous checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, current checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0
[0m14:56:02.335066 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:56:02.335561 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:56:02.335959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a185df74-c3db-44f9-a5ca-55af5b24856e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22255aeb30>]}
[0m14:56:03.869813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a185df74-c3db-44f9-a5ca-55af5b24856e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2220474a00>]}
[0m14:56:03.967893 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:56:03.969669 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:56:03.979980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a185df74-c3db-44f9-a5ca-55af5b24856e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2222941900>]}
[0m14:56:03.980473 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 434 macros
[0m14:56:03.980817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a185df74-c3db-44f9-a5ca-55af5b24856e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22205a8c10>]}
[0m14:56:03.982113 [info ] [MainThread]: 
[0m14:56:03.982464 [info ] [MainThread]: Concurrency: 4 threads (target='shop')
[0m14:56:03.982770 [info ] [MainThread]: 
[0m14:56:03.983353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:56:03.989120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop'
[0m14:56:04.023111 [debug] [ThreadPool]: Using postgres connection "list_shop"
[0m14:56:04.023608 [debug] [ThreadPool]: On list_shop: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop"} */

    select distinct nspname from pg_namespace
  
[0m14:56:04.023881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:04.032691 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m14:56:04.033923 [debug] [ThreadPool]: On list_shop: Close
[0m14:56:04.035723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_shop, now list_shop_public)
[0m14:56:04.037492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop_public_public'
[0m14:56:04.044894 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m14:56:04.045467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop_public_data'
[0m14:56:04.048209 [debug] [ThreadPool]: Using postgres connection "list_shop_public_public"
[0m14:56:04.048656 [debug] [ThreadPool]: On list_shop_public: BEGIN
[0m14:56:04.050708 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m14:56:04.051072 [debug] [ThreadPool]: On list_shop_public_public: BEGIN
[0m14:56:04.051433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:04.051934 [debug] [ThreadPool]: On list_shop_public_data: BEGIN
[0m14:56:04.052438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:04.053057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:04.061650 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:56:04.062080 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m14:56:04.062357 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:56:04.062779 [debug] [ThreadPool]: Using postgres connection "list_shop_public_public"
[0m14:56:04.063147 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m14:56:04.063558 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m14:56:04.063944 [debug] [ThreadPool]: On list_shop_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public_public"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:56:04.064348 [debug] [ThreadPool]: On list_shop_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:56:04.064790 [debug] [ThreadPool]: On list_shop_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public_data"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_data'
  
[0m14:56:04.067308 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:56:04.068783 [debug] [ThreadPool]: On list_shop_public_public: ROLLBACK
[0m14:56:04.069287 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m14:56:04.069637 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m14:56:04.070991 [debug] [ThreadPool]: On list_shop_public: ROLLBACK
[0m14:56:04.071409 [debug] [ThreadPool]: On list_shop_public_public: Close
[0m14:56:04.072650 [debug] [ThreadPool]: On list_shop_public_data: ROLLBACK
[0m14:56:04.073346 [debug] [ThreadPool]: On list_shop_public: Close
[0m14:56:04.073655 [debug] [ThreadPool]: On list_shop_public_data: Close
[0m14:56:04.080507 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:04.080833 [debug] [MainThread]: On master: BEGIN
[0m14:56:04.081092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:04.087798 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:56:04.088273 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:04.088676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:56:04.092052 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:56:04.093141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a185df74-c3db-44f9-a5ca-55af5b24856e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2220477520>]}
[0m14:56:04.093582 [debug] [MainThread]: On master: ROLLBACK
[0m14:56:04.094050 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:04.094317 [debug] [MainThread]: On master: BEGIN
[0m14:56:04.094983 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:56:04.095322 [debug] [MainThread]: On master: COMMIT
[0m14:56:04.095656 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:04.095976 [debug] [MainThread]: On master: COMMIT
[0m14:56:04.096435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:56:04.096714 [debug] [MainThread]: On master: Close
[0m14:56:04.100052 [debug] [Thread-1 (]: Began running node seed.dbt_playground.customers
[0m14:56:04.100532 [debug] [Thread-2 (]: Began running node seed.dbt_playground.products
[0m14:56:04.101043 [info ] [Thread-1 (]: 1 of 2 START seed file public_public.customers ................................. [RUN]
[0m14:56:04.101835 [info ] [Thread-2 (]: 2 of 2 START seed file public_public.products .................................. [RUN]
[0m14:56:04.102760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_shop_public_data, now seed.dbt_playground.customers)
[0m14:56:04.103437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_shop_public, now seed.dbt_playground.products)
[0m14:56:04.103955 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.customers
[0m14:56:04.104384 [debug] [Thread-2 (]: Began compiling node seed.dbt_playground.products
[0m14:56:04.104862 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.customers
[0m14:56:04.105322 [debug] [Thread-2 (]: Began executing node seed.dbt_playground.products
[0m14:56:04.156151 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m14:56:04.158089 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m14:56:04.158527 [debug] [Thread-2 (]: On seed.dbt_playground.products: BEGIN
[0m14:56:04.158959 [debug] [Thread-1 (]: On seed.dbt_playground.customers: BEGIN
[0m14:56:04.159367 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:04.159819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:04.167388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:56:04.167906 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m14:56:04.168340 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m14:56:04.168767 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m14:56:04.169190 [debug] [Thread-1 (]: On seed.dbt_playground.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.customers"} */
truncate table "shop"."public_public"."customers"
[0m14:56:04.169657 [debug] [Thread-2 (]: On seed.dbt_playground.products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.products"} */
truncate table "shop"."public_public"."products"
[0m14:56:04.173356 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m14:56:04.179535 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.009 seconds
[0m14:56:04.194555 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m14:56:04.196696 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m14:56:04.197064 [debug] [Thread-1 (]: On seed.dbt_playground.customers: 
          insert into "shop"."public_public"."customers" ("id", "name", "email", "signup_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:56:04.197479 [debug] [Thread-2 (]: On seed.dbt_playground.products: 
          insert into "shop"."public_public"."products" ("id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m14:56:04.198507 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m14:56:04.198880 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m14:56:04.204051 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_playground.customers"
[0m14:56:04.204780 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_playground.products"
[0m14:56:04.231517 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m14:56:04.232740 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m14:56:04.233202 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m14:56:04.233637 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m14:56:04.234057 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m14:56:04.234484 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m14:56:04.236296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:56:04.238641 [debug] [Thread-1 (]: On seed.dbt_playground.customers: Close
[0m14:56:04.239033 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m14:56:04.240082 [debug] [Thread-2 (]: On seed.dbt_playground.products: Close
[0m14:56:04.241968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a185df74-c3db-44f9-a5ca-55af5b24856e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22229409d0>]}
[0m14:56:04.242520 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a185df74-c3db-44f9-a5ca-55af5b24856e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2222d78850>]}
[0m14:56:04.243061 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public_public.customers ............................. [[32mINSERT 3[0m in 0.14s]
[0m14:56:04.243922 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public_public.products .............................. [[32mINSERT 3[0m in 0.14s]
[0m14:56:04.244813 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.customers
[0m14:56:04.245488 [debug] [Thread-2 (]: Finished running node seed.dbt_playground.products
[0m14:56:04.247912 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:04.248286 [debug] [MainThread]: On master: BEGIN
[0m14:56:04.248607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:04.255724 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:56:04.256156 [debug] [MainThread]: On master: COMMIT
[0m14:56:04.256502 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:04.256828 [debug] [MainThread]: On master: COMMIT
[0m14:56:04.257288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:56:04.257573 [debug] [MainThread]: On master: Close
[0m14:56:04.258025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:04.258281 [debug] [MainThread]: Connection 'seed.dbt_playground.products' was properly closed.
[0m14:56:04.258521 [debug] [MainThread]: Connection 'list_shop_public_public' was properly closed.
[0m14:56:04.258756 [debug] [MainThread]: Connection 'seed.dbt_playground.customers' was properly closed.
[0m14:56:04.259063 [info ] [MainThread]: 
[0m14:56:04.259390 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:56:04.260245 [debug] [MainThread]: Command end result
[0m14:56:04.284809 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:56:04.286423 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:56:04.292675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:56:04.292946 [info ] [MainThread]: 
[0m14:56:04.293349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:04.293670 [info ] [MainThread]: 
[0m14:56:04.294096 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:56:04.295107 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.555874, "process_in_blocks": "0", "process_kernel_time": 0.210309, "process_mem_max_rss": "135992", "process_out_blocks": "2640", "process_user_time": 3.705444}
[0m14:56:04.295527 [debug] [MainThread]: Command `dbt seed` succeeded at 14:56:04.295435 after 2.56 seconds
[0m14:56:04.295895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2225de42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2222943eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2222941ed0>]}
[0m14:56:04.296227 [debug] [MainThread]: Flushing usage events
[0m14:56:05.176521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:38.645916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3350e5c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334fe20430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334fe203d0>]}


============================== 15:04:38.649348 | 8338ac7f-43e5-4642-830c-d52533147b9b ==============================
[0m15:04:38.649348 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:04:38.649829 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'log_path': '/usr/app/dbt_project/logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'fail_fast': 'False', 'invocation_command': 'dbt seed --target dev --select iceberg --debug'}
[0m15:04:38.904026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8338ac7f-43e5-4642-830c-d52533147b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334fe20460>]}
[0m15:04:38.993744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8338ac7f-43e5-4642-830c-d52533147b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3350eecbb0>]}
[0m15:04:38.994468 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m15:04:39.084769 [debug] [MainThread]: checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0, vars: {}, profile: , target: dev, version: 1.11.2
[0m15:04:39.212000 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:04:39.212552 [debug] [MainThread]: previous checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0, current checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900
[0m15:04:39.212935 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:04:39.213343 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:04:39.213692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8338ac7f-43e5-4642-830c-d52533147b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3350646b30>]}
[0m15:04:40.934475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8338ac7f-43e5-4642-830c-d52533147b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334d2dfcd0>]}
[0m15:04:41.038729 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:04:41.041160 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:04:41.051499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8338ac7f-43e5-4642-830c-d52533147b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334f5ad690>]}
[0m15:04:41.052102 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 455 macros
[0m15:04:41.052490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8338ac7f-43e5-4642-830c-d52533147b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334f4d9c00>]}
[0m15:04:41.053935 [info ] [MainThread]: 
[0m15:04:41.054319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:41.054636 [info ] [MainThread]: 
[0m15:04:41.055258 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:04:41.056455 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:04:41.105276 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:04:41.105826 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:04:41.106235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:41.106575 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:04:41.107020 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '8338ac7f-43e5-4642-830c-d52533147b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334d2dce80>]}
[0m15:04:41.159221 [debug] [ThreadPool]: SQL status: SUCCESS in 0.053 seconds
[0m15:04:41.160775 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:04:41.167629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_public_data)
[0m15:04:41.168984 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public_public'
[0m15:04:41.187775 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public'
[0m15:04:41.188408 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_data"
[0m15:04:41.193530 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_public"
[0m15:04:41.199020 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m15:04:41.199957 [debug] [ThreadPool]: On list_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_data"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_data') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_data'
[0m15:04:41.200602 [debug] [ThreadPool]: On list_iceberg_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_public'
[0m15:04:41.201187 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m15:04:41.201709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:41.202199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:41.202726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:41.398695 [debug] [ThreadPool]: SQL status: SUCCESS in 0.197 seconds
[0m15:04:41.400620 [debug] [ThreadPool]: On list_iceberg_public_data: ROLLBACK
[0m15:04:41.402548 [debug] [ThreadPool]: SQL status: SUCCESS in 0.200 seconds
[0m15:04:41.403414 [debug] [ThreadPool]: SQL status: SUCCESS in 0.201 seconds
[0m15:04:41.403868 [debug] [ThreadPool]: On list_iceberg_public_data: Close
[0m15:04:41.406073 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m15:04:41.407806 [debug] [ThreadPool]: On list_iceberg_public_public: ROLLBACK
[0m15:04:41.408990 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m15:04:41.409965 [debug] [ThreadPool]: On list_iceberg_public_public: Close
[0m15:04:41.412804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8338ac7f-43e5-4642-830c-d52533147b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334f76c8e0>]}
[0m15:04:41.413563 [debug] [MainThread]: On master: COMMIT
[0m15:04:41.418942 [debug] [Thread-1 (]: Began running node seed.dbt_playground.events
[0m15:04:41.419745 [info ] [Thread-1 (]: 1 of 1 START seed file public_data.events ...................................... [RUN]
[0m15:04:41.420326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public_public, now seed.dbt_playground.events)
[0m15:04:41.420785 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.events
[0m15:04:41.421212 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.events
[0m15:04:41.454111 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."public_data"."events"
[0m15:04:41.456339 [debug] [Thread-1 (]: Using trino connection "seed.dbt_playground.events"
[0m15:04:41.456762 [debug] [Thread-1 (]: On seed.dbt_playground.events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "seed.dbt_playground.events"} */

    drop table if exists "iceberg"."public_data"."events"
[0m15:04:41.457160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:41.516957 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20260111_150443_00029_vv9a2
[0m15:04:41.517542 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'events'", query_id=20260111_150443_00029_vv9a2)
[0m15:04:41.518438 [debug] [Thread-1 (]: On seed.dbt_playground.events: Close
[0m15:04:41.525548 [debug] [Thread-1 (]: Database Error in seed events (seeds/iceberg/events.csv)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'events'", query_id=20260111_150443_00029_vv9a2)
[0m15:04:41.528031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8338ac7f-43e5-4642-830c-d52533147b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334fd45450>]}
[0m15:04:41.528722 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public_data.events .............................. [[31mERROR[0m in 0.11s]
[0m15:04:41.529315 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.events
[0m15:04:41.530007 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_playground.events' to be skipped because of status 'error'.  Reason: Database Error in seed events (seeds/iceberg/events.csv)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'events'", query_id=20260111_150443_00029_vv9a2).
[0m15:04:41.532395 [debug] [MainThread]: On master: COMMIT
[0m15:04:41.532959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:41.533295 [debug] [MainThread]: Connection 'list_iceberg_public_data' was properly closed.
[0m15:04:41.533651 [debug] [MainThread]: Connection 'seed.dbt_playground.events' was properly closed.
[0m15:04:41.533977 [debug] [MainThread]: Connection 'list_iceberg_public' was properly closed.
[0m15:04:41.534355 [info ] [MainThread]: 
[0m15:04:41.534727 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m15:04:41.535491 [debug] [MainThread]: Command end result
[0m15:04:41.564024 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:04:41.568180 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:04:41.575722 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:04:41.576245 [info ] [MainThread]: 
[0m15:04:41.576761 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:04:41.577244 [info ] [MainThread]: 
[0m15:04:41.577765 [error] [MainThread]: [31mFailure in seed events (seeds/iceberg/events.csv)[0m
[0m15:04:41.578340 [error] [MainThread]:   Database Error in seed events (seeds/iceberg/events.csv)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'events'", query_id=20260111_150443_00029_vv9a2)
[0m15:04:41.578803 [info ] [MainThread]: 
[0m15:04:41.579326 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:04:41.581086 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.016157, "process_in_blocks": "73096", "process_kernel_time": 0.287122, "process_mem_max_rss": "127228", "process_out_blocks": "2816", "process_user_time": 3.950405}
[0m15:04:41.581721 [debug] [MainThread]: Command `dbt seed` failed at 15:04:41.581571 after 3.02 seconds
[0m15:04:41.582340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3350e5c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3350eecbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3350eee3e0>]}
[0m15:04:41.582937 [debug] [MainThread]: Flushing usage events
[0m15:04:42.435864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:14.421479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd3c10520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd2be0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd2be0730>]}


============================== 15:22:14.428396 | 8c629005-3946-4d5c-8ae1-4274b2f90aa9 ==============================
[0m15:22:14.428396 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:22:14.428895 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt seed --target dev --select iceberg', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'static_parser': 'True', 'no_print': 'None', 'log_format': 'default', 'log_path': '/usr/app/dbt_project/logs', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/root/.dbt'}
[0m15:22:14.677968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c629005-3946-4d5c-8ae1-4274b2f90aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd2b52cb0>]}
[0m15:22:14.765251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c629005-3946-4d5c-8ae1-4274b2f90aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd33d1bd0>]}
[0m15:22:14.765909 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m15:22:14.851917 [debug] [MainThread]: checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0, vars: {}, profile: , target: dev, version: 1.11.2
[0m15:22:15.021071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:15.021511 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:22:15.021767 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:15.079953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c629005-3946-4d5c-8ae1-4274b2f90aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd23c0be0>]}
[0m15:22:15.234617 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:22:15.239397 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:22:15.248273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c629005-3946-4d5c-8ae1-4274b2f90aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd2588b80>]}
[0m15:22:15.248734 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 455 macros
[0m15:22:15.249082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c629005-3946-4d5c-8ae1-4274b2f90aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd24b25c0>]}
[0m15:22:15.250408 [info ] [MainThread]: 
[0m15:22:15.250756 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:15.251066 [info ] [MainThread]: 
[0m15:22:15.251632 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:22:15.252657 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:22:15.301757 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:22:15.302170 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:22:15.302455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:15.302747 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:22:15.303192 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '8c629005-3946-4d5c-8ae1-4274b2f90aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd2e3a2f0>]}
[0m15:22:16.409791 [debug] [ThreadPool]: SQL status: SUCCESS in 1.107 seconds
[0m15:22:16.411657 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:22:16.413058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_public_data)
[0m15:22:16.413788 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "public_data"
"
[0m15:22:16.422006 [debug] [ThreadPool]: Using trino connection "create_iceberg_public_data"
[0m15:22:16.422791 [debug] [ThreadPool]: On create_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_iceberg_public_data"} */
create schema if not exists "iceberg"."public_data"
[0m15:22:16.423247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:16.634851 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.212 seconds
[0m15:22:16.635905 [debug] [ThreadPool]: On create_iceberg_public_data: COMMIT
[0m15:22:16.636317 [debug] [ThreadPool]: On create_iceberg_public_data: Close
[0m15:22:16.643462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_public_data, now list_iceberg_public)
[0m15:22:16.644298 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public_data'
[0m15:22:16.644985 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public_public'
[0m15:22:16.665092 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m15:22:16.670460 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_data"
[0m15:22:16.676032 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_public"
[0m15:22:16.676487 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m15:22:16.676976 [debug] [ThreadPool]: On list_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_data"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_data') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_data'
[0m15:22:16.677395 [debug] [ThreadPool]: On list_iceberg_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_public'
[0m15:22:16.677796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:16.678209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:16.678604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:17.489584 [debug] [ThreadPool]: SQL status: SUCCESS in 0.812 seconds
[0m15:22:17.491268 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m15:22:17.492366 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m15:22:17.512045 [debug] [ThreadPool]: SQL status: SUCCESS in 0.833 seconds
[0m15:22:17.513968 [debug] [ThreadPool]: On list_iceberg_public_public: ROLLBACK
[0m15:22:17.514603 [debug] [ThreadPool]: SQL status: SUCCESS in 0.836 seconds
[0m15:22:17.514958 [debug] [ThreadPool]: On list_iceberg_public_public: Close
[0m15:22:17.516406 [debug] [ThreadPool]: On list_iceberg_public_data: ROLLBACK
[0m15:22:17.517249 [debug] [ThreadPool]: On list_iceberg_public_data: Close
[0m15:22:17.518312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c629005-3946-4d5c-8ae1-4274b2f90aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd2ba2aa0>]}
[0m15:22:17.518768 [debug] [MainThread]: On master: COMMIT
[0m15:22:17.525098 [debug] [Thread-1 (]: Began running node seed.dbt_playground.events
[0m15:22:17.525770 [info ] [Thread-1 (]: 1 of 1 START seed file public_data.events ...................................... [RUN]
[0m15:22:17.526275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public_data, now seed.dbt_playground.events)
[0m15:22:17.526634 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.events
[0m15:22:17.526999 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.events
[0m15:22:17.572089 [debug] [Thread-1 (]: Using trino connection "seed.dbt_playground.events"
[0m15:22:17.572576 [debug] [Thread-1 (]: On seed.dbt_playground.events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "seed.dbt_playground.events"} */

    create table "iceberg"."public_data"."events" ("event_id" VARCHAR,"user_id" INTEGER,"event_type" VARCHAR,"event_time" TIMESTAMP)
[0m15:22:17.572961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:19.125638 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 1.553 seconds
[0m15:22:19.154506 [debug] [Thread-1 (]: Using trino connection "seed.dbt_playground.events"
[0m15:22:19.154932 [debug] [Thread-1 (]: On seed.dbt_playground.events: insert into "iceberg"."public_data"."events" ("event_id", "user_id", "event_type", "event_time") values
          (?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?)...
[0m15:22:20.583052 [debug] [Thread-1 (]: SQL status: INSERT (4 rows) in 1.428 seconds
[0m15:22:20.590053 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_playground.events"
[0m15:22:20.611274 [debug] [Thread-1 (]: On seed.dbt_playground.events: COMMIT
[0m15:22:20.613583 [debug] [Thread-1 (]: On seed.dbt_playground.events: Close
[0m15:22:20.615714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c629005-3946-4d5c-8ae1-4274b2f90aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd57a0be0>]}
[0m15:22:20.616260 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_data.events .................................. [[32mINSERT 4[0m in 3.09s]
[0m15:22:20.616823 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.events
[0m15:22:20.618719 [debug] [MainThread]: On master: COMMIT
[0m15:22:20.619193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:20.619461 [debug] [MainThread]: Connection 'list_iceberg_public' was properly closed.
[0m15:22:20.619717 [debug] [MainThread]: Connection 'seed.dbt_playground.events' was properly closed.
[0m15:22:20.620106 [debug] [MainThread]: Connection 'list_iceberg_public_public' was properly closed.
[0m15:22:20.620519 [info ] [MainThread]: 
[0m15:22:20.620944 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m15:22:20.621876 [debug] [MainThread]: Command end result
[0m15:22:20.648477 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:22:20.650239 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:22:20.656753 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:22:20.657079 [info ] [MainThread]: 
[0m15:22:20.657510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:20.657853 [info ] [MainThread]: 
[0m15:22:20.658309 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:22:20.659768 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.3245783, "process_in_blocks": "49912", "process_kernel_time": 0.292786, "process_mem_max_rss": "118420", "process_out_blocks": "2888", "process_user_time": 2.524024}
[0m15:22:20.660292 [debug] [MainThread]: Command `dbt seed` succeeded at 15:22:20.660180 after 6.33 seconds
[0m15:22:20.660719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd3c10520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd570f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd2b52cb0>]}
[0m15:22:20.661184 [debug] [MainThread]: Flushing usage events
[0m15:22:21.525905 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:25.642545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfcdfc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfbdbc5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfbdbc550>]}


============================== 15:22:25.645111 | f4dda2bb-7f51-4da0-9fe5-28b4e707a09a ==============================
[0m15:22:25.645111 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:22:25.645585 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/usr/app/dbt_project/logs', 'empty': 'None', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt seed --target shop --select shop'}
[0m15:22:25.875134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4dda2bb-7f51-4da0-9fe5-28b4e707a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfbef3eb0>]}
[0m15:22:25.967725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4dda2bb-7f51-4da0-9fe5-28b4e707a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfc7780a0>]}
[0m15:22:25.972985 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:22:26.054625 [debug] [MainThread]: checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, vars: {}, profile: , target: shop, version: 1.11.2
[0m15:22:26.182738 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:22:26.183279 [debug] [MainThread]: previous checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, current checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0
[0m15:22:26.183667 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:22:26.184101 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:22:26.184544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4dda2bb-7f51-4da0-9fe5-28b4e707a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfc5e6b30>]}
[0m15:22:27.733792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4dda2bb-7f51-4da0-9fe5-28b4e707a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd33b9fc0>]}
[0m15:22:27.834080 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:22:27.836079 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:22:27.847298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4dda2bb-7f51-4da0-9fe5-28b4e707a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf95060e0>]}
[0m15:22:27.847814 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 434 macros
[0m15:22:27.848153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4dda2bb-7f51-4da0-9fe5-28b4e707a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf9968b50>]}
[0m15:22:27.849508 [info ] [MainThread]: 
[0m15:22:27.849851 [info ] [MainThread]: Concurrency: 4 threads (target='shop')
[0m15:22:27.850168 [info ] [MainThread]: 
[0m15:22:27.850719 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:27.855355 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop'
[0m15:22:27.891704 [debug] [ThreadPool]: Using postgres connection "list_shop"
[0m15:22:27.892146 [debug] [ThreadPool]: On list_shop: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop"} */

    select distinct nspname from pg_namespace
  
[0m15:22:27.892429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:27.914109 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.022 seconds
[0m15:22:27.916074 [debug] [ThreadPool]: On list_shop: Close
[0m15:22:27.917272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_shop, now create_shop_public_public)
[0m15:22:27.917816 [debug] [ThreadPool]: Creating schema "database: "shop"
schema: "public_public"
"
[0m15:22:27.923682 [debug] [ThreadPool]: Using postgres connection "create_shop_public_public"
[0m15:22:27.924045 [debug] [ThreadPool]: On create_shop_public_public: BEGIN
[0m15:22:27.924309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:27.930933 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:22:27.931351 [debug] [ThreadPool]: Using postgres connection "create_shop_public_public"
[0m15:22:27.931638 [debug] [ThreadPool]: On create_shop_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "create_shop_public_public"} */
create schema if not exists "public_public"
[0m15:22:27.932348 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m15:22:27.933460 [debug] [ThreadPool]: On create_shop_public_public: COMMIT
[0m15:22:27.933928 [debug] [ThreadPool]: Using postgres connection "create_shop_public_public"
[0m15:22:27.934207 [debug] [ThreadPool]: On create_shop_public_public: COMMIT
[0m15:22:27.935717 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:22:27.936055 [debug] [ThreadPool]: On create_shop_public_public: Close
[0m15:22:27.937738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_shop_public_public, now list_shop_public_public)
[0m15:22:27.938438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop_public'
[0m15:22:27.944500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop_public_data'
[0m15:22:27.946384 [debug] [ThreadPool]: Using postgres connection "list_shop_public_public"
[0m15:22:27.948892 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m15:22:27.951619 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m15:22:27.952130 [debug] [ThreadPool]: On list_shop_public_public: BEGIN
[0m15:22:27.952552 [debug] [ThreadPool]: On list_shop_public: BEGIN
[0m15:22:27.952979 [debug] [ThreadPool]: On list_shop_public_data: BEGIN
[0m15:22:27.953379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:27.953869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:27.954374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:27.962731 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:22:27.963178 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:22:27.963572 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:22:27.963979 [debug] [ThreadPool]: Using postgres connection "list_shop_public_public"
[0m15:22:27.964364 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m15:22:27.964709 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m15:22:27.965076 [debug] [ThreadPool]: On list_shop_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public_public"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m15:22:27.965465 [debug] [ThreadPool]: On list_shop_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:22:27.965848 [debug] [ThreadPool]: On list_shop_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public_data"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_data'
  
[0m15:22:27.969289 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:22:27.969704 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:22:27.970156 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m15:22:27.971299 [debug] [ThreadPool]: On list_shop_public: ROLLBACK
[0m15:22:27.972371 [debug] [ThreadPool]: On list_shop_public_public: ROLLBACK
[0m15:22:27.973554 [debug] [ThreadPool]: On list_shop_public_data: ROLLBACK
[0m15:22:27.974075 [debug] [ThreadPool]: On list_shop_public: Close
[0m15:22:27.974415 [debug] [ThreadPool]: On list_shop_public_public: Close
[0m15:22:27.974748 [debug] [ThreadPool]: On list_shop_public_data: Close
[0m15:22:27.980797 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:27.981155 [debug] [MainThread]: On master: BEGIN
[0m15:22:27.981422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:27.988160 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:22:27.988531 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:27.988869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:22:27.991598 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:22:27.992691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4dda2bb-7f51-4da0-9fe5-28b4e707a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf952e680>]}
[0m15:22:27.993123 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:27.993606 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:27.993898 [debug] [MainThread]: On master: BEGIN
[0m15:22:27.994468 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:22:27.994750 [debug] [MainThread]: On master: COMMIT
[0m15:22:27.995028 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:27.995297 [debug] [MainThread]: On master: COMMIT
[0m15:22:27.995702 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:27.995995 [debug] [MainThread]: On master: Close
[0m15:22:27.999356 [debug] [Thread-1 (]: Began running node seed.dbt_playground.customers
[0m15:22:27.999771 [debug] [Thread-2 (]: Began running node seed.dbt_playground.products
[0m15:22:28.000364 [info ] [Thread-1 (]: 1 of 2 START seed file public_public.customers ................................. [RUN]
[0m15:22:28.001100 [info ] [Thread-2 (]: 2 of 2 START seed file public_public.products .................................. [RUN]
[0m15:22:28.001769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_shop_public_data, now seed.dbt_playground.customers)
[0m15:22:28.002261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_shop_public_public, now seed.dbt_playground.products)
[0m15:22:28.002666 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.customers
[0m15:22:28.003082 [debug] [Thread-2 (]: Began compiling node seed.dbt_playground.products
[0m15:22:28.003559 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.customers
[0m15:22:28.003966 [debug] [Thread-2 (]: Began executing node seed.dbt_playground.products
[0m15:22:28.045202 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:22:28.047141 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:22:28.047641 [debug] [Thread-2 (]: On seed.dbt_playground.products: BEGIN
[0m15:22:28.048097 [debug] [Thread-1 (]: On seed.dbt_playground.customers: BEGIN
[0m15:22:28.048488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:22:28.048873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:28.056022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:22:28.056572 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:22:28.056953 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m15:22:28.057321 [debug] [Thread-1 (]: On seed.dbt_playground.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.customers"} */

    create table "shop"."public_public"."customers" ("id" integer,"name" text,"email" text,"signup_date" date)
  
[0m15:22:28.057718 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:22:28.058190 [debug] [Thread-2 (]: On seed.dbt_playground.products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.products"} */

    create table "shop"."public_public"."products" ("id" integer,"name" text,"price" float8)
  
[0m15:22:28.062051 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m15:22:28.068258 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.010 seconds
[0m15:22:28.080001 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:22:28.082499 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:22:28.082911 [debug] [Thread-1 (]: On seed.dbt_playground.customers: 
          insert into "shop"."public_public"."customers" ("id", "name", "email", "signup_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m15:22:28.083320 [debug] [Thread-2 (]: On seed.dbt_playground.products: 
          insert into "shop"."public_public"."products" ("id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m15:22:28.084284 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.000 seconds
[0m15:22:28.084675 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m15:22:28.090332 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_playground.customers"
[0m15:22:28.091055 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_playground.products"
[0m15:22:28.116281 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m15:22:28.116901 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m15:22:28.117331 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:22:28.117731 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:22:28.118126 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m15:22:28.118518 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m15:22:28.120067 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:22:28.122153 [debug] [Thread-2 (]: On seed.dbt_playground.products: Close
[0m15:22:28.122603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:22:28.123384 [debug] [Thread-1 (]: On seed.dbt_playground.customers: Close
[0m15:22:28.125451 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4dda2bb-7f51-4da0-9fe5-28b4e707a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfd0b0940>]}
[0m15:22:28.126100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4dda2bb-7f51-4da0-9fe5-28b4e707a09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfbd747f0>]}
[0m15:22:28.126638 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public_public.products .............................. [[32mINSERT 3[0m in 0.12s]
[0m15:22:28.127278 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public_public.customers ............................. [[32mINSERT 3[0m in 0.12s]
[0m15:22:28.127933 [debug] [Thread-2 (]: Finished running node seed.dbt_playground.products
[0m15:22:28.128488 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.customers
[0m15:22:28.130562 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:28.130869 [debug] [MainThread]: On master: BEGIN
[0m15:22:28.131140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:28.137693 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:22:28.138137 [debug] [MainThread]: On master: COMMIT
[0m15:22:28.138445 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:28.138720 [debug] [MainThread]: On master: COMMIT
[0m15:22:28.139176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:28.139477 [debug] [MainThread]: On master: Close
[0m15:22:28.139972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:28.140237 [debug] [MainThread]: Connection 'seed.dbt_playground.products' was properly closed.
[0m15:22:28.140488 [debug] [MainThread]: Connection 'list_shop_public' was properly closed.
[0m15:22:28.140738 [debug] [MainThread]: Connection 'seed.dbt_playground.customers' was properly closed.
[0m15:22:28.141093 [info ] [MainThread]: 
[0m15:22:28.141462 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:22:28.142413 [debug] [MainThread]: Command end result
[0m15:22:28.169781 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:22:28.171714 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:22:28.178401 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:22:28.178691 [info ] [MainThread]: 
[0m15:22:28.179110 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:28.179443 [info ] [MainThread]: 
[0m15:22:28.179872 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:22:28.180707 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.6181731, "process_in_blocks": "18784", "process_kernel_time": 0.238538, "process_mem_max_rss": "136228", "process_out_blocks": "2640", "process_user_time": 3.727162}
[0m15:22:28.181134 [debug] [MainThread]: Command `dbt seed` succeeded at 15:22:28.181015 after 2.62 seconds
[0m15:22:28.181466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfcdfc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcfccb7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf9d60100>]}
[0m15:22:28.181801 [debug] [MainThread]: Flushing usage events
[0m15:22:29.111496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:41.371178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d0796c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06918520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d069184c0>]}


============================== 15:22:41.373741 | 4c97f124-9d81-4b74-975e-83169993e8a8 ==============================
[0m15:22:41.373741 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:22:41.374218 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'empty': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True'}
[0m15:22:41.604636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06918550>]}
[0m15:22:41.692818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06aef7c0>]}
[0m15:22:41.693688 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m15:22:41.777636 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:22:41.904478 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:22:41.904953 [debug] [MainThread]: previous checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, current checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900
[0m15:22:41.905229 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:22:41.905569 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:22:41.905990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d07156b30>]}
[0m15:22:43.546455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccfd4ec50>]}
[0m15:22:43.649370 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:22:43.651187 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:22:43.657992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06264970>]}
[0m15:22:43.658543 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 455 macros
[0m15:22:43.658896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06267e50>]}
[0m15:22:43.660542 [info ] [MainThread]: 
[0m15:22:43.660932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:43.661264 [info ] [MainThread]: 
[0m15:22:43.661859 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:22:43.669366 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:22:43.711767 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:22:43.712189 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:22:43.712472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:43.712740 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:22:43.713188 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d060992d0>]}
[0m15:22:43.781126 [debug] [ThreadPool]: SQL status: SUCCESS in 0.069 seconds
[0m15:22:43.782601 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:22:43.783451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_public)
[0m15:22:43.783948 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "public"
"
[0m15:22:43.788884 [debug] [ThreadPool]: Using trino connection "create_iceberg_public"
[0m15:22:43.789217 [debug] [ThreadPool]: On create_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_iceberg_public"} */
create schema if not exists "iceberg"."public"
[0m15:22:43.789495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:43.828813 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.039 seconds
[0m15:22:43.829858 [debug] [ThreadPool]: On create_iceberg_public: COMMIT
[0m15:22:43.830160 [debug] [ThreadPool]: On create_iceberg_public: Close
[0m15:22:43.832047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_public, now list_iceberg_public_public)
[0m15:22:43.832722 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public_data'
[0m15:22:43.833401 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public'
[0m15:22:43.852807 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_public"
[0m15:22:43.858666 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_data"
[0m15:22:43.863743 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m15:22:43.864152 [debug] [ThreadPool]: On list_iceberg_public_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_public'
[0m15:22:43.864591 [debug] [ThreadPool]: On list_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_data"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_data') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_data'
[0m15:22:43.865123 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m15:22:43.865610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:43.865974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:43.866346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:44.111278 [debug] [ThreadPool]: SQL status: SUCCESS in 0.245 seconds
[0m15:22:44.113219 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m15:22:44.114106 [debug] [ThreadPool]: SQL status: SUCCESS in 0.248 seconds
[0m15:22:44.114643 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m15:22:44.116078 [debug] [ThreadPool]: On list_iceberg_public_public: ROLLBACK
[0m15:22:44.117223 [debug] [ThreadPool]: On list_iceberg_public_public: Close
[0m15:22:44.165717 [debug] [ThreadPool]: SQL status: SUCCESS in 0.300 seconds
[0m15:22:44.167265 [debug] [ThreadPool]: On list_iceberg_public_data: ROLLBACK
[0m15:22:44.167607 [debug] [ThreadPool]: On list_iceberg_public_data: Close
[0m15:22:44.169169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccfd63f70>]}
[0m15:22:44.169804 [debug] [MainThread]: On master: COMMIT
[0m15:22:44.174094 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_customers
[0m15:22:44.174707 [debug] [Thread-2 (]: Began running node model.dbt_playground.stg_events
[0m15:22:44.175604 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_customers ............................... [RUN]
[0m15:22:44.176547 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_events .................................. [RUN]
[0m15:22:44.177616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public_public, now model.dbt_playground.stg_customers)
[0m15:22:44.178400 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_public_data, now model.dbt_playground.stg_events)
[0m15:22:44.178992 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_customers
[0m15:22:44.179739 [debug] [Thread-2 (]: Began compiling node model.dbt_playground.stg_events
[0m15:22:44.184722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_customers"
[0m15:22:44.189314 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m15:22:44.190765 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_customers
[0m15:22:44.191391 [debug] [Thread-2 (]: Began executing node model.dbt_playground.stg_events
[0m15:22:44.232365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_customers"
[0m15:22:44.236400 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m15:22:44.238362 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.stg_customers"
[0m15:22:44.239488 [debug] [Thread-2 (]: Using trino connection "model.dbt_playground.stg_events"
[0m15:22:44.239851 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_customers"} */

  create or replace view
    "iceberg"."public"."stg_customers"
  security definer
  as
    select
    id as customer_id,
    name,
    email
from "postgres"."public"."customers"
  
[0m15:22:44.240269 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  create or replace view
    "iceberg"."public"."stg_events"
  security definer
  as
    select
    event_id,
    user_id as customer_id,
    event_type,
    event_time
from "iceberg"."data"."events"
  
[0m15:22:44.240665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:44.241068 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:22:44.483651 [debug] [Thread-2 (]: Trino adapter: Trino query id: 20260111_152244_00014_9si5x
[0m15:22:44.484297 [debug] [Thread-2 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 12:6: Schema 'data' does not exist", query_id=20260111_152244_00014_9si5x)
[0m15:22:44.484958 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: ROLLBACK
[0m15:22:44.485673 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: Close
[0m15:22:44.493238 [debug] [Thread-2 (]: Database Error in model stg_events (models/staging/stg_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 12:6: Schema 'data' does not exist", query_id=20260111_152244_00014_9si5x)
  compiled code at target/run/dbt_playground/models/staging/stg_events.sql
[0m15:22:44.495418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06541a20>]}
[0m15:22:44.496061 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.stg_events ......................... [[31mERROR[0m in 0.32s]
[0m15:22:44.497019 [debug] [Thread-2 (]: Finished running node model.dbt_playground.stg_events
[0m15:22:44.497772 [debug] [Thread-7 (]: Marking all children of 'model.dbt_playground.stg_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_events (models/staging/stg_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 12:6: Schema 'data' does not exist", query_id=20260111_152244_00014_9si5x)
  compiled code at target/run/dbt_playground/models/staging/stg_events.sql.
[0m15:22:44.591386 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20260111_152244_00013_9si5x
[0m15:22:44.591947 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 11:6: Table 'postgres.public.customers' does not exist", query_id=20260111_152244_00013_9si5x)
[0m15:22:44.592456 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: ROLLBACK
[0m15:22:44.592777 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: Close
[0m15:22:44.593807 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 11:6: Table 'postgres.public.customers' does not exist", query_id=20260111_152244_00013_9si5x)
  compiled code at target/run/dbt_playground/models/staging/stg_customers.sql
[0m15:22:44.594442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c97f124-9d81-4b74-975e-83169993e8a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06031570>]}
[0m15:22:44.595030 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.42s]
[0m15:22:44.595578 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_customers
[0m15:22:44.596220 [debug] [Thread-7 (]: Marking all children of 'model.dbt_playground.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 11:6: Table 'postgres.public.customers' does not exist", query_id=20260111_152244_00013_9si5x)
  compiled code at target/run/dbt_playground/models/staging/stg_customers.sql.
[0m15:22:44.597388 [debug] [Thread-4 (]: Began running node model.dbt_playground.customer_summary
[0m15:22:44.598020 [info ] [Thread-4 (]: 3 of 3 SKIP relation public.customer_summary ................................... [[33mSKIP[0m]
[0m15:22:44.598544 [debug] [Thread-4 (]: Finished running node model.dbt_playground.customer_summary
[0m15:22:44.600739 [debug] [MainThread]: On master: COMMIT
[0m15:22:44.601269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:44.601565 [debug] [MainThread]: Connection 'model.dbt_playground.stg_customers' was properly closed.
[0m15:22:44.601833 [debug] [MainThread]: Connection 'model.dbt_playground.stg_events' was properly closed.
[0m15:22:44.602237 [debug] [MainThread]: Connection 'list_iceberg_public' was properly closed.
[0m15:22:44.602625 [info ] [MainThread]: 
[0m15:22:44.602965 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m15:22:44.603977 [debug] [MainThread]: Command end result
[0m15:22:44.630754 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:22:44.632980 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:22:44.639821 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:22:44.640174 [info ] [MainThread]: 
[0m15:22:44.640548 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:22:44.640921 [info ] [MainThread]: 
[0m15:22:44.641437 [error] [MainThread]: [31mFailure in model stg_events (models/staging/stg_events.sql)[0m
[0m15:22:44.641870 [error] [MainThread]:   Database Error in model stg_events (models/staging/stg_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 12:6: Schema 'data' does not exist", query_id=20260111_152244_00014_9si5x)
  compiled code at target/run/dbt_playground/models/staging/stg_events.sql
[0m15:22:44.642175 [info ] [MainThread]: 
[0m15:22:44.642647 [info ] [MainThread]:   compiled code at target/compiled/dbt_playground/models/staging/stg_events.sql
[0m15:22:44.642993 [info ] [MainThread]: 
[0m15:22:44.643437 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m15:22:44.643859 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 11:6: Table 'postgres.public.customers' does not exist", query_id=20260111_152244_00013_9si5x)
  compiled code at target/run/dbt_playground/models/staging/stg_customers.sql
[0m15:22:44.644172 [info ] [MainThread]: 
[0m15:22:44.644618 [info ] [MainThread]:   compiled code at target/compiled/dbt_playground/models/staging/stg_customers.sql
[0m15:22:44.644956 [info ] [MainThread]: 
[0m15:22:44.645349 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=3
[0m15:22:44.646250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3566191, "process_in_blocks": "624", "process_kernel_time": 0.229503, "process_mem_max_rss": "130256", "process_out_blocks": "2864", "process_user_time": 3.891585}
[0m15:22:44.646648 [debug] [MainThread]: Command `dbt run` failed at 15:22:44.646558 after 3.36 seconds
[0m15:22:44.646998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d0796c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06151d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccfdc4490>]}
[0m15:22:44.647333 [debug] [MainThread]: Flushing usage events
[0m15:22:45.578258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:43.560792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfdfc8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfcf844f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfcf84490>]}


============================== 15:33:43.564625 | ebaad068-9362-4f9d-87b6-6c1b33818a02 ==============================
[0m15:33:43.564625 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:33:43.565141 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt seed --target shop --select shop --full-refresh', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_format': 'default', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'log_path': '/usr/app/dbt_project/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False'}
[0m15:33:43.805468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebaad068-9362-4f9d-87b6-6c1b33818a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfcf84be0>]}
[0m15:33:43.895867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebaad068-9362-4f9d-87b6-6c1b33818a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfcf84490>]}
[0m15:33:43.897063 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:33:43.982308 [debug] [MainThread]: checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, vars: {}, profile: , target: shop, version: 1.11.2
[0m15:33:44.112814 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:33:44.113291 [debug] [MainThread]: previous checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, current checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b
[0m15:33:44.113562 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:33:44.113897 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:33:44.114216 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:33:44.114666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebaad068-9362-4f9d-87b6-6c1b33818a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfd7b2b30>]}
[0m15:33:45.730023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebaad068-9362-4f9d-87b6-6c1b33818a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf869e200>]}
[0m15:33:45.830626 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:33:45.832976 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:33:45.850915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebaad068-9362-4f9d-87b6-6c1b33818a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfab86e30>]}
[0m15:33:45.851409 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 434 macros
[0m15:33:45.851765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebaad068-9362-4f9d-87b6-6c1b33818a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfab87820>]}
[0m15:33:45.853064 [info ] [MainThread]: 
[0m15:33:45.853403 [info ] [MainThread]: Concurrency: 4 threads (target='shop')
[0m15:33:45.853707 [info ] [MainThread]: 
[0m15:33:45.854318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:45.860059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop'
[0m15:33:45.903358 [debug] [ThreadPool]: Using postgres connection "list_shop"
[0m15:33:45.903778 [debug] [ThreadPool]: On list_shop: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop"} */

    select distinct nspname from pg_namespace
  
[0m15:33:45.904081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:45.931038 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m15:33:45.932819 [debug] [ThreadPool]: On list_shop: Close
[0m15:33:45.935633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_shop, now list_shop_public_data)
[0m15:33:45.936591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop_public'
[0m15:33:45.945709 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m15:33:45.949029 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m15:33:45.949635 [debug] [ThreadPool]: On list_shop_public_data: BEGIN
[0m15:33:45.950195 [debug] [ThreadPool]: On list_shop_public: BEGIN
[0m15:33:45.950774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:45.951447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:45.961180 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:33:45.961781 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m15:33:45.962243 [debug] [ThreadPool]: On list_shop_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public_data"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_data'
  
[0m15:33:45.963678 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:33:45.964263 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m15:33:45.964653 [debug] [ThreadPool]: On list_shop_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:33:45.967739 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m15:33:45.969410 [debug] [ThreadPool]: On list_shop_public_data: ROLLBACK
[0m15:33:45.969927 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m15:33:45.971417 [debug] [ThreadPool]: On list_shop_public: ROLLBACK
[0m15:33:45.971837 [debug] [ThreadPool]: On list_shop_public_data: Close
[0m15:33:45.972505 [debug] [ThreadPool]: On list_shop_public: Close
[0m15:33:45.981336 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:45.981886 [debug] [MainThread]: On master: BEGIN
[0m15:33:45.982381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:45.991533 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:33:45.991983 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:45.992440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:33:45.998655 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m15:33:46.000671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebaad068-9362-4f9d-87b6-6c1b33818a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfaf77df0>]}
[0m15:33:46.001536 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:46.002365 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:46.002795 [debug] [MainThread]: On master: BEGIN
[0m15:33:46.003673 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:33:46.004172 [debug] [MainThread]: On master: COMMIT
[0m15:33:46.004564 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:46.004934 [debug] [MainThread]: On master: COMMIT
[0m15:33:46.005561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:46.006029 [debug] [MainThread]: On master: Close
[0m15:33:46.011317 [debug] [Thread-1 (]: Began running node seed.dbt_playground.customers
[0m15:33:46.012144 [debug] [Thread-2 (]: Began running node seed.dbt_playground.products
[0m15:33:46.012834 [info ] [Thread-1 (]: 1 of 2 START seed file public.customers ........................................ [RUN]
[0m15:33:46.013776 [info ] [Thread-2 (]: 2 of 2 START seed file public.products ......................................... [RUN]
[0m15:33:46.014664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_shop_public_data, now seed.dbt_playground.customers)
[0m15:33:46.015334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_shop_public, now seed.dbt_playground.products)
[0m15:33:46.015798 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.customers
[0m15:33:46.016440 [debug] [Thread-2 (]: Began compiling node seed.dbt_playground.products
[0m15:33:46.017000 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.customers
[0m15:33:46.017488 [debug] [Thread-2 (]: Began executing node seed.dbt_playground.products
[0m15:33:46.065343 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:33:46.066980 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:33:46.067345 [debug] [Thread-1 (]: On seed.dbt_playground.customers: BEGIN
[0m15:33:46.067774 [debug] [Thread-2 (]: On seed.dbt_playground.products: BEGIN
[0m15:33:46.068213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:46.068622 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:46.077276 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m15:33:46.077974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:33:46.078482 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:33:46.078971 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:33:46.079451 [debug] [Thread-2 (]: On seed.dbt_playground.products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.products"} */

    create table "shop"."public"."products" ("id" integer,"name" text,"price" float8)
  
[0m15:33:46.079889 [debug] [Thread-1 (]: On seed.dbt_playground.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.customers"} */

    create table "shop"."public"."customers" ("id" integer,"name" text,"email" text,"signup_date" date)
  
[0m15:33:46.084967 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m15:33:46.091058 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.011 seconds
[0m15:33:46.106038 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:33:46.108001 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:33:46.108570 [debug] [Thread-1 (]: On seed.dbt_playground.customers: 
          insert into "shop"."public"."customers" ("id", "name", "email", "signup_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m15:33:46.109194 [debug] [Thread-2 (]: On seed.dbt_playground.products: 
          insert into "shop"."public"."products" ("id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m15:33:46.110399 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m15:33:46.117123 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_playground.customers"
[0m15:33:46.117695 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.008 seconds
[0m15:33:46.118566 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_playground.products"
[0m15:33:46.156412 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m15:33:46.154894 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m15:33:46.157002 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:33:46.157433 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:33:46.157879 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m15:33:46.158296 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m15:33:46.160094 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:33:46.162616 [debug] [Thread-1 (]: On seed.dbt_playground.customers: Close
[0m15:33:46.163112 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m15:33:46.163885 [debug] [Thread-2 (]: On seed.dbt_playground.products: Close
[0m15:33:46.166570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebaad068-9362-4f9d-87b6-6c1b33818a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfb306e60>]}
[0m15:33:46.166965 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebaad068-9362-4f9d-87b6-6c1b33818a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf861e4d0>]}
[0m15:33:46.167604 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.customers .................................... [[32mCREATE 3[0m in 0.15s]
[0m15:33:46.168324 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.products ..................................... [[32mCREATE 3[0m in 0.15s]
[0m15:33:46.169067 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.customers
[0m15:33:46.169633 [debug] [Thread-2 (]: Finished running node seed.dbt_playground.products
[0m15:33:46.171839 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:46.172182 [debug] [MainThread]: On master: BEGIN
[0m15:33:46.172495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:46.179629 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:33:46.180130 [debug] [MainThread]: On master: COMMIT
[0m15:33:46.180477 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:46.180854 [debug] [MainThread]: On master: COMMIT
[0m15:33:46.181430 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:46.181781 [debug] [MainThread]: On master: Close
[0m15:33:46.182348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:46.182649 [debug] [MainThread]: Connection 'seed.dbt_playground.customers' was properly closed.
[0m15:33:46.182946 [debug] [MainThread]: Connection 'seed.dbt_playground.products' was properly closed.
[0m15:33:46.183337 [info ] [MainThread]: 
[0m15:33:46.183759 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:33:46.184892 [debug] [MainThread]: Command end result
[0m15:33:46.215780 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:33:46.217674 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:33:46.225014 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:33:46.225389 [info ] [MainThread]: 
[0m15:33:46.225855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:46.226277 [info ] [MainThread]: 
[0m15:33:46.226822 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:33:46.228398 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.7489123, "process_in_blocks": "87936", "process_kernel_time": 0.298513, "process_mem_max_rss": "132624", "process_out_blocks": "2640", "process_user_time": 3.81102}
[0m15:33:46.228812 [debug] [MainThread]: Command `dbt seed` succeeded at 15:33:46.228719 after 2.75 seconds
[0m15:33:46.229140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfdfc8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfab86dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfde82b60>]}
[0m15:33:46.229470 [debug] [MainThread]: Flushing usage events
[0m15:33:47.231570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:51.451439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c70642e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c6004520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c60044c0>]}


============================== 15:33:51.454016 | b1e401ec-89bc-4faf-b77f-dadb8704c9fd ==============================
[0m15:33:51.454016 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:33:51.454487 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'partial_parse': 'True', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '/root/.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m15:33:51.697222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c6004550>]}
[0m15:33:51.785770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c61d37c0>]}
[0m15:33:51.786426 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m15:33:51.875489 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:33:52.005382 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:33:52.005854 [debug] [MainThread]: previous checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, current checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900
[0m15:33:52.006135 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:33:52.006503 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:33:52.006859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c682eb30>]}
[0m15:33:53.677308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359f599c30>]}
[0m15:33:53.777731 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:33:53.779686 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:33:53.786019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c58286d0>]}
[0m15:33:53.786466 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 455 macros
[0m15:33:53.786816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c5828670>]}
[0m15:33:53.788263 [info ] [MainThread]: 
[0m15:33:53.788614 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:53.788976 [info ] [MainThread]: 
[0m15:33:53.789622 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:33:53.795316 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:33:53.838612 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:33:53.839049 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:33:53.839334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:53.839588 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:33:53.840062 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359f429090>]}
[0m15:33:53.898662 [debug] [ThreadPool]: SQL status: SUCCESS in 0.059 seconds
[0m15:33:53.900483 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:33:53.902762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_public_data)
[0m15:33:53.903670 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public'
[0m15:33:53.922160 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_data"
[0m15:33:53.928016 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m15:33:53.928567 [debug] [ThreadPool]: On list_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_data"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_data') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_data'
[0m15:33:53.929068 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m15:33:53.929443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:53.929794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:54.070258 [debug] [ThreadPool]: SQL status: SUCCESS in 0.140 seconds
[0m15:33:54.071947 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m15:33:54.072491 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m15:33:54.101907 [debug] [ThreadPool]: SQL status: SUCCESS in 0.172 seconds
[0m15:33:54.103581 [debug] [ThreadPool]: On list_iceberg_public_data: ROLLBACK
[0m15:33:54.103988 [debug] [ThreadPool]: On list_iceberg_public_data: Close
[0m15:33:54.105104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c8d30dc0>]}
[0m15:33:54.105608 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.109626 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_customers
[0m15:33:54.110043 [debug] [Thread-2 (]: Began running node model.dbt_playground.stg_events
[0m15:33:54.110681 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_customers ............................... [RUN]
[0m15:33:54.111291 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_events .................................. [RUN]
[0m15:33:54.112130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public_data, now model.dbt_playground.stg_customers)
[0m15:33:54.112878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now model.dbt_playground.stg_events)
[0m15:33:54.113337 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_customers
[0m15:33:54.113785 [debug] [Thread-2 (]: Began compiling node model.dbt_playground.stg_events
[0m15:33:54.117104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_customers"
[0m15:33:54.120301 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m15:33:54.121177 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_customers
[0m15:33:54.121617 [debug] [Thread-2 (]: Began executing node model.dbt_playground.stg_events
[0m15:33:54.149117 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_customers"
[0m15:33:54.150685 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m15:33:54.152303 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.stg_customers"
[0m15:33:54.153419 [debug] [Thread-2 (]: Using trino connection "model.dbt_playground.stg_events"
[0m15:33:54.153783 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_customers"} */

  create or replace view
    "iceberg"."public"."stg_customers"
  security definer
  as
    select
    id as customer_id,
    name,
    email
from "postgres"."public"."customers"
  
[0m15:33:54.154192 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  create or replace view
    "iceberg"."public"."stg_events"
  security definer
  as
    select
    event_id,
    user_id as customer_id,
    event_type,
    event_time
from "iceberg"."public_data"."events"
  
[0m15:33:54.154595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:54.154987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:54.394431 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.239 seconds
[0m15:33:54.416199 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.261 seconds
[0m15:33:54.420409 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: ROLLBACK
[0m15:33:54.422897 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: ROLLBACK
[0m15:33:54.423428 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: Close
[0m15:33:54.423904 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: Close
[0m15:33:54.426606 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359f43d900>]}
[0m15:33:54.427618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359f5693f0>]}
[0m15:33:54.428426 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_events ............................. [[32mCREATE VIEW[0m in 0.31s]
[0m15:33:54.429301 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m15:33:54.430039 [debug] [Thread-2 (]: Finished running node model.dbt_playground.stg_events
[0m15:33:54.431154 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_customers
[0m15:33:54.433119 [debug] [Thread-4 (]: Began running node model.dbt_playground.customer_summary
[0m15:33:54.434110 [info ] [Thread-4 (]: 3 of 3 START sql table model public.customer_summary ........................... [RUN]
[0m15:33:54.434798 [debug] [Thread-4 (]: Acquiring new trino connection 'model.dbt_playground.customer_summary'
[0m15:33:54.435178 [debug] [Thread-4 (]: Began compiling node model.dbt_playground.customer_summary
[0m15:33:54.441239 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_playground.customer_summary"
[0m15:33:54.442099 [debug] [Thread-4 (]: Began executing node model.dbt_playground.customer_summary
[0m15:33:54.513786 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_playground.customer_summary"
[0m15:33:54.517581 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_summary"
[0m15:33:54.518340 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_summary"} */

  
    

    create table "iceberg"."public"."customer_summary"
      
      
    as (
      with customers as (
    select * from "iceberg"."public"."stg_customers"
),
events as (
    select * from "iceberg"."public"."stg_events"
)
select
    c.customer_id,
    c.name,
    count(e.event_id) as total_events
from customers c
left join events e on c.customer_id = e.customer_id
group by 1, 2
    )
[0m15:33:54.518978 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:33:55.674639 [debug] [Thread-4 (]: SQL status: CREATE TABLE (3 rows) in 1.156 seconds
[0m15:33:55.676956 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: ROLLBACK
[0m15:33:55.677470 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: Close
[0m15:33:55.678397 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e401ec-89bc-4faf-b77f-dadb8704c9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c5bf79d0>]}
[0m15:33:55.679208 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.customer_summary ...................... [[32mCREATE TABLE (3 rows)[0m in 1.24s]
[0m15:33:55.679952 [debug] [Thread-4 (]: Finished running node model.dbt_playground.customer_summary
[0m15:33:55.682106 [debug] [MainThread]: On master: COMMIT
[0m15:33:55.682641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:55.682914 [debug] [MainThread]: Connection 'model.dbt_playground.stg_customers' was properly closed.
[0m15:33:55.683176 [debug] [MainThread]: Connection 'model.dbt_playground.stg_events' was properly closed.
[0m15:33:55.683433 [debug] [MainThread]: Connection 'model.dbt_playground.customer_summary' was properly closed.
[0m15:33:55.683970 [info ] [MainThread]: 
[0m15:33:55.684400 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m15:33:55.685635 [debug] [MainThread]: Command end result
[0m15:33:55.716328 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:33:55.718369 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:33:55.725326 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:33:55.725603 [info ] [MainThread]: 
[0m15:33:55.725973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:55.726292 [info ] [MainThread]: 
[0m15:33:55.726746 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:33:55.727577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3576856, "process_in_blocks": "2864", "process_kernel_time": 0.227618, "process_mem_max_rss": "130680", "process_out_blocks": "2872", "process_user_time": 3.988266}
[0m15:33:55.728042 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:55.727885 after 4.36 seconds
[0m15:33:55.728445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c70642e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359f42d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c7119660>]}
[0m15:33:55.728853 [debug] [MainThread]: Flushing usage events
[0m15:33:56.666949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:28.157056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23807602b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237f700520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237f7004c0>]}


============================== 15:37:28.161258 | 6c384283-17e2-4faf-87fc-beb51c35355d ==============================
[0m15:37:28.161258 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:37:28.161873 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'introspect': 'True', 'write_json': 'True', 'log_path': '/usr/app/dbt_project/logs', 'no_print': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'empty': 'False', 'quiet': 'False', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s marts.customer_summary'}
[0m15:37:28.417271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c384283-17e2-4faf-87fc-beb51c35355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237f700550>]}
[0m15:37:28.505929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c384283-17e2-4faf-87fc-beb51c35355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237fa5abf0>]}
[0m15:37:28.506581 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m15:37:28.594540 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:37:28.799147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:28.799577 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:37:28.799823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:28.856276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c384283-17e2-4faf-87fc-beb51c35355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237eec86a0>]}
[0m15:37:29.012698 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:37:29.017725 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:37:29.027782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c384283-17e2-4faf-87fc-beb51c35355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237f03e6e0>]}
[0m15:37:29.028368 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 455 macros
[0m15:37:29.028807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c384283-17e2-4faf-87fc-beb51c35355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237efee440>]}
[0m15:37:29.030146 [info ] [MainThread]: 
[0m15:37:29.030533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:29.030858 [info ] [MainThread]: 
[0m15:37:29.031456 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:37:29.032444 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:37:29.081565 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:37:29.081998 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:37:29.082289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:29.082533 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:37:29.083219 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '6c384283-17e2-4faf-87fc-beb51c35355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237eea7b50>]}
[0m15:37:29.142706 [debug] [ThreadPool]: SQL status: SUCCESS in 0.060 seconds
[0m15:37:29.144018 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:37:29.151855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_public)
[0m15:37:29.152795 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public_data'
[0m15:37:29.174048 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m15:37:29.180405 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_data"
[0m15:37:29.181089 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m15:37:29.181662 [debug] [ThreadPool]: On list_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_data"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_data') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_data'
[0m15:37:29.182121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:29.182560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:29.334574 [debug] [ThreadPool]: SQL status: SUCCESS in 0.152 seconds
[0m15:37:29.336167 [debug] [ThreadPool]: On list_iceberg_public_data: ROLLBACK
[0m15:37:29.336567 [debug] [ThreadPool]: On list_iceberg_public_data: Close
[0m15:37:29.349969 [debug] [ThreadPool]: SQL status: SUCCESS in 0.168 seconds
[0m15:37:29.351768 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m15:37:29.352236 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m15:37:29.353863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c384283-17e2-4faf-87fc-beb51c35355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237f03f010>]}
[0m15:37:29.354367 [debug] [MainThread]: On master: COMMIT
[0m15:37:29.360077 [debug] [Thread-1 (]: Began running node model.dbt_playground.customer_summary
[0m15:37:29.360972 [info ] [Thread-1 (]: 1 of 1 START sql table model public.customer_summary ........................... [RUN]
[0m15:37:29.361627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now model.dbt_playground.customer_summary)
[0m15:37:29.362094 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.customer_summary
[0m15:37:29.366756 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.customer_summary"
[0m15:37:29.367595 [debug] [Thread-1 (]: Began executing node model.dbt_playground.customer_summary
[0m15:37:29.435824 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.customer_summary"
[0m15:37:29.438048 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.customer_summary"
[0m15:37:29.438480 [debug] [Thread-1 (]: On model.dbt_playground.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_summary"} */

  
    

    create table "iceberg"."public"."customer_summary__dbt_tmp"
      
      
    as (
      with customers as (
    select * from "iceberg"."public"."stg_customers"
),
events as (
    select * from "iceberg"."public"."stg_events"
)
select
    c.customer_id,
    c.name,
    count(e.event_id) as total_events
from customers c
left join events e on c.customer_id = e.customer_id
group by 1, 2
    )
[0m15:37:29.438841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:29.913177 [debug] [Thread-1 (]: SQL status: CREATE TABLE (3 rows) in 0.474 seconds
[0m15:37:29.921607 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.customer_summary"
[0m15:37:29.922186 [debug] [Thread-1 (]: On model.dbt_playground.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_summary"} */
alter table "iceberg"."public"."customer_summary" rename to "iceberg"."public"."customer_summary__dbt_backup"
[0m15:37:30.022259 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.100 seconds
[0m15:37:30.025859 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.customer_summary"
[0m15:37:30.026197 [debug] [Thread-1 (]: On model.dbt_playground.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_summary"} */
alter table "iceberg"."public"."customer_summary__dbt_tmp" rename to "iceberg"."public"."customer_summary"
[0m15:37:30.117485 [debug] [Thread-1 (]: SQL status: RENAME TABLE in 0.091 seconds
[0m15:37:30.125549 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."public"."customer_summary__dbt_backup"
[0m15:37:30.127447 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.customer_summary"
[0m15:37:30.127783 [debug] [Thread-1 (]: On model.dbt_playground.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_summary"} */

    drop table if exists "iceberg"."public"."customer_summary__dbt_backup"
[0m15:37:30.182286 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20260111_153730_00027_9si5x
[0m15:37:30.182787 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_summary__dbt_backup'", query_id=20260111_153730_00027_9si5x)
[0m15:37:30.183229 [debug] [Thread-1 (]: On model.dbt_playground.customer_summary: ROLLBACK
[0m15:37:30.183543 [debug] [Thread-1 (]: On model.dbt_playground.customer_summary: Close
[0m15:37:30.189646 [debug] [Thread-1 (]: Database Error in model customer_summary (models/marts/customer_summary.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_summary__dbt_backup'", query_id=20260111_153730_00027_9si5x)
  compiled code at target/run/dbt_playground/models/marts/customer_summary.sql
[0m15:37:30.191628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c384283-17e2-4faf-87fc-beb51c35355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237e347b50>]}
[0m15:37:30.192223 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.customer_summary .................. [[31mERROR[0m in 0.83s]
[0m15:37:30.192818 [debug] [Thread-1 (]: Finished running node model.dbt_playground.customer_summary
[0m15:37:30.193563 [debug] [Thread-7 (]: Marking all children of 'model.dbt_playground.customer_summary' to be skipped because of status 'error'.  Reason: Database Error in model customer_summary (models/marts/customer_summary.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_summary__dbt_backup'", query_id=20260111_153730_00027_9si5x)
  compiled code at target/run/dbt_playground/models/marts/customer_summary.sql.
[0m15:37:30.195872 [debug] [MainThread]: On master: COMMIT
[0m15:37:30.196270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:30.196539 [debug] [MainThread]: Connection 'model.dbt_playground.customer_summary' was properly closed.
[0m15:37:30.196800 [debug] [MainThread]: Connection 'list_iceberg_public_data' was properly closed.
[0m15:37:30.197093 [info ] [MainThread]: 
[0m15:37:30.197585 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m15:37:30.198274 [debug] [MainThread]: Command end result
[0m15:37:30.223308 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:37:30.225226 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:37:30.232335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:37:30.232730 [info ] [MainThread]: 
[0m15:37:30.233125 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:37:30.233520 [info ] [MainThread]: 
[0m15:37:30.234106 [error] [MainThread]: [31mFailure in model customer_summary (models/marts/customer_summary.sql)[0m
[0m15:37:30.234625 [error] [MainThread]:   Database Error in model customer_summary (models/marts/customer_summary.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CATALOG_ERROR, message="Failed to drop table 'customer_summary__dbt_backup'", query_id=20260111_153730_00027_9si5x)
  compiled code at target/run/dbt_playground/models/marts/customer_summary.sql
[0m15:37:30.235008 [info ] [MainThread]: 
[0m15:37:30.235421 [info ] [MainThread]:   compiled code at target/compiled/dbt_playground/models/marts/customer_summary.sql
[0m15:37:30.235804 [info ] [MainThread]: 
[0m15:37:30.236203 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:37:30.237766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1654358, "process_in_blocks": "73728", "process_kernel_time": 0.215656, "process_mem_max_rss": "118864", "process_out_blocks": "1920", "process_user_time": 2.489851}
[0m15:37:30.238319 [debug] [MainThread]: Command `dbt run` failed at 15:37:30.238203 after 2.17 seconds
[0m15:37:30.238735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23807602b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23807ef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237f3556c0>]}
[0m15:37:30.239164 [debug] [MainThread]: Flushing usage events
[0m15:37:31.182644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:01.603930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f44bbc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f43b80790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f43b80730>]}


============================== 15:44:01.609167 | 431ad9be-6989-493a-a346-06f32a081ce9 ==============================
[0m15:44:01.609167 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:44:01.609660 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt seed --target dev --select iceberg', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': '/usr/app/dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'None', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '/root/.dbt'}
[0m15:44:01.837271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '431ad9be-6989-493a-a346-06f32a081ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f43b146a0>]}
[0m15:44:01.925373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '431ad9be-6989-493a-a346-06f32a081ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f44579bd0>]}
[0m15:44:01.926021 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m15:44:02.010470 [debug] [MainThread]: checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0, vars: {}, profile: , target: dev, version: 1.11.2
[0m15:44:02.136770 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:44:02.137233 [debug] [MainThread]: previous checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0, current checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b
[0m15:44:02.137534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '431ad9be-6989-493a-a346-06f32a081ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f438d48b0>]}
[0m15:44:03.768998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '431ad9be-6989-493a-a346-06f32a081ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f431fad40>]}
[0m15:44:03.869139 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:44:03.870870 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:44:03.878023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '431ad9be-6989-493a-a346-06f32a081ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f43327c40>]}
[0m15:44:03.878596 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 455 macros
[0m15:44:03.878943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '431ad9be-6989-493a-a346-06f32a081ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f434afb50>]}
[0m15:44:03.880147 [info ] [MainThread]: 
[0m15:44:03.880489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:44:03.880806 [info ] [MainThread]: 
[0m15:44:03.881407 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:44:03.882297 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:44:03.927759 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:44:03.928207 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:44:03.928486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:03.928749 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:44:03.929184 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '431ad9be-6989-493a-a346-06f32a081ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f432da9b0>]}
[0m15:44:04.989460 [debug] [ThreadPool]: SQL status: SUCCESS in 1.061 seconds
[0m15:44:04.990994 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:44:04.992116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_public_data)
[0m15:44:04.992628 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "public_data"
"
[0m15:44:04.998478 [debug] [ThreadPool]: Using trino connection "create_iceberg_public_data"
[0m15:44:04.998997 [debug] [ThreadPool]: On create_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_iceberg_public_data"} */
create schema if not exists "iceberg"."public_data"
[0m15:44:04.999296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:05.117035 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.118 seconds
[0m15:44:05.118063 [debug] [ThreadPool]: On create_iceberg_public_data: COMMIT
[0m15:44:05.118365 [debug] [ThreadPool]: On create_iceberg_public_data: Close
[0m15:44:05.125134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_public_data, now list_iceberg_public_data)
[0m15:44:05.127323 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public'
[0m15:44:05.145398 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_data"
[0m15:44:05.150602 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m15:44:05.150992 [debug] [ThreadPool]: On list_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_data"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_data') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_data'
[0m15:44:05.151435 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m15:44:05.151872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:05.152216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:05.873462 [debug] [ThreadPool]: SQL status: SUCCESS in 0.721 seconds
[0m15:44:05.875365 [debug] [ThreadPool]: On list_iceberg_public_data: ROLLBACK
[0m15:44:05.875896 [debug] [ThreadPool]: On list_iceberg_public_data: Close
[0m15:44:05.890820 [debug] [ThreadPool]: SQL status: SUCCESS in 0.738 seconds
[0m15:44:05.893012 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m15:44:05.893787 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m15:44:05.895377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '431ad9be-6989-493a-a346-06f32a081ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f4684d3f0>]}
[0m15:44:05.896233 [debug] [MainThread]: On master: COMMIT
[0m15:44:05.905723 [debug] [Thread-1 (]: Began running node seed.dbt_playground.events
[0m15:44:05.906714 [info ] [Thread-1 (]: 1 of 1 START seed file public_data.events ...................................... [RUN]
[0m15:44:05.907547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now seed.dbt_playground.events)
[0m15:44:05.908132 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.events
[0m15:44:05.908689 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.events
[0m15:44:05.973719 [debug] [Thread-1 (]: Using trino connection "seed.dbt_playground.events"
[0m15:44:05.974372 [debug] [Thread-1 (]: On seed.dbt_playground.events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "seed.dbt_playground.events"} */

    create table "iceberg"."public_data"."events" ("event_id" VARCHAR,"user_id" INTEGER,"event_type" VARCHAR,"event_time" TIMESTAMP)
[0m15:44:05.974879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:07.742395 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 1.767 seconds
[0m15:44:07.772234 [debug] [Thread-1 (]: Using trino connection "seed.dbt_playground.events"
[0m15:44:07.772673 [debug] [Thread-1 (]: On seed.dbt_playground.events: insert into "iceberg"."public_data"."events" ("event_id", "user_id", "event_type", "event_time") values
          (?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?)...
[0m15:44:08.849846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27a49c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb279460580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb279460520>]}


============================== 15:44:08.852916 | 113ee00c-53a8-4b89-8327-e4a21dea0e81 ==============================
[0m15:44:08.852916 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:44:08.853518 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'log_format': 'default', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --target shop --select shop', 'printer_width': '80', 'static_parser': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'fail_fast': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False'}
[0m15:44:09.096473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '113ee00c-53a8-4b89-8327-e4a21dea0e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb278746b60>]}
[0m15:44:09.205240 [debug] [Thread-1 (]: SQL status: INSERT (4 rows) in 1.432 seconds
[0m15:44:09.206193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '113ee00c-53a8-4b89-8327-e4a21dea0e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27941e8c0>]}
[0m15:44:09.207321 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:44:09.212541 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_playground.events"
[0m15:44:09.237222 [debug] [Thread-1 (]: On seed.dbt_playground.events: COMMIT
[0m15:44:09.239270 [debug] [Thread-1 (]: On seed.dbt_playground.events: Close
[0m15:44:09.240979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '431ad9be-6989-493a-a346-06f32a081ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f437867d0>]}
[0m15:44:09.241468 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_data.events .................................. [[32mINSERT 4[0m in 3.33s]
[0m15:44:09.242093 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.events
[0m15:44:09.244295 [debug] [MainThread]: On master: COMMIT
[0m15:44:09.244784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:09.245095 [debug] [MainThread]: Connection 'list_iceberg_public_data' was properly closed.
[0m15:44:09.245395 [debug] [MainThread]: Connection 'seed.dbt_playground.events' was properly closed.
[0m15:44:09.245796 [info ] [MainThread]: 
[0m15:44:09.246204 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m15:44:09.247005 [debug] [MainThread]: Command end result
[0m15:44:09.273947 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:44:09.275606 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:44:09.282924 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:44:09.283292 [info ] [MainThread]: 
[0m15:44:09.283678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:09.284091 [info ] [MainThread]: 
[0m15:44:09.284813 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:44:09.285751 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.7602925, "process_in_blocks": "9056", "process_kernel_time": 0.190001, "process_mem_max_rss": "126944", "process_out_blocks": "3792", "process_user_time": 4.060023}
[0m15:44:09.286187 [debug] [MainThread]: Command `dbt seed` succeeded at 15:44:09.286085 after 7.76 seconds
[0m15:44:09.286560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f44bbc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f43b146a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f44c56110>]}
[0m15:44:09.286965 [debug] [MainThread]: Flushing usage events
[0m15:44:09.290493 [debug] [MainThread]: checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, vars: {}, profile: , target: shop, version: 1.11.2
[0m15:44:09.410656 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:44:09.411104 [debug] [MainThread]: previous checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900, current checksum: 6de8998cdfeafeb43e6ae3fe32b8c9d26625374c1f127e1db61e64862c5ab9c0
[0m15:44:09.411612 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:44:09.412044 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:44:09.412400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '113ee00c-53a8-4b89-8327-e4a21dea0e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb279c86b30>]}
[0m15:44:10.239569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:11.023657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '113ee00c-53a8-4b89-8327-e4a21dea0e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb274b77310>]}
[0m15:44:11.119007 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:44:11.120653 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:44:11.131292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '113ee00c-53a8-4b89-8327-e4a21dea0e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2773d7a00>]}
[0m15:44:11.131774 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 434 macros
[0m15:44:11.132098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '113ee00c-53a8-4b89-8327-e4a21dea0e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27730d270>]}
[0m15:44:11.133348 [info ] [MainThread]: 
[0m15:44:11.133674 [info ] [MainThread]: Concurrency: 4 threads (target='shop')
[0m15:44:11.133947 [info ] [MainThread]: 
[0m15:44:11.134567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:11.138955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop'
[0m15:44:11.185837 [debug] [ThreadPool]: Using postgres connection "list_shop"
[0m15:44:11.186378 [debug] [ThreadPool]: On list_shop: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop"} */

    select distinct nspname from pg_namespace
  
[0m15:44:11.186781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:11.211125 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m15:44:11.212728 [debug] [ThreadPool]: On list_shop: Close
[0m15:44:11.214379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_shop, now list_shop_public)
[0m15:44:11.215186 [debug] [ThreadPool]: Acquiring new postgres connection 'list_shop_public_data'
[0m15:44:11.221508 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m15:44:11.223935 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m15:44:11.224538 [debug] [ThreadPool]: On list_shop_public: BEGIN
[0m15:44:11.225039 [debug] [ThreadPool]: On list_shop_public_data: BEGIN
[0m15:44:11.225431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:11.225836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:11.234285 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:44:11.234793 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:44:11.235104 [debug] [ThreadPool]: Using postgres connection "list_shop_public"
[0m15:44:11.235455 [debug] [ThreadPool]: Using postgres connection "list_shop_public_data"
[0m15:44:11.235915 [debug] [ThreadPool]: On list_shop_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:44:11.236306 [debug] [ThreadPool]: On list_shop_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "list_shop_public_data"} */
select
      'shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_data'
    union all
    select
      'shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_data'
  
[0m15:44:11.240066 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:44:11.240642 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m15:44:11.242159 [debug] [ThreadPool]: On list_shop_public_data: ROLLBACK
[0m15:44:11.243521 [debug] [ThreadPool]: On list_shop_public: ROLLBACK
[0m15:44:11.244222 [debug] [ThreadPool]: On list_shop_public_data: Close
[0m15:44:11.244567 [debug] [ThreadPool]: On list_shop_public: Close
[0m15:44:11.250578 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:11.251073 [debug] [MainThread]: On master: BEGIN
[0m15:44:11.251386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:11.259854 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:44:11.260326 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:11.260666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:44:11.264245 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:44:11.265477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '113ee00c-53a8-4b89-8327-e4a21dea0e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb274bcf100>]}
[0m15:44:11.266027 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:11.266623 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:11.266933 [debug] [MainThread]: On master: BEGIN
[0m15:44:11.267742 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:44:11.268201 [debug] [MainThread]: On master: COMMIT
[0m15:44:11.268604 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:11.268934 [debug] [MainThread]: On master: COMMIT
[0m15:44:11.269414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:11.269763 [debug] [MainThread]: On master: Close
[0m15:44:11.273643 [debug] [Thread-1 (]: Began running node seed.dbt_playground.customers
[0m15:44:11.274259 [debug] [Thread-2 (]: Began running node seed.dbt_playground.products
[0m15:44:11.274943 [info ] [Thread-1 (]: 1 of 2 START seed file public.customers ........................................ [RUN]
[0m15:44:11.275781 [info ] [Thread-2 (]: 2 of 2 START seed file public.products ......................................... [RUN]
[0m15:44:11.276707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_shop_public, now seed.dbt_playground.customers)
[0m15:44:11.277330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_shop_public_data, now seed.dbt_playground.products)
[0m15:44:11.277811 [debug] [Thread-1 (]: Began compiling node seed.dbt_playground.customers
[0m15:44:11.278323 [debug] [Thread-2 (]: Began compiling node seed.dbt_playground.products
[0m15:44:11.278993 [debug] [Thread-1 (]: Began executing node seed.dbt_playground.customers
[0m15:44:11.279596 [debug] [Thread-2 (]: Began executing node seed.dbt_playground.products
[0m15:44:11.323984 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:44:11.325218 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:44:11.325726 [debug] [Thread-1 (]: On seed.dbt_playground.customers: BEGIN
[0m15:44:11.326265 [debug] [Thread-2 (]: On seed.dbt_playground.products: BEGIN
[0m15:44:11.326761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:11.327250 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:44:11.337112 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m15:44:11.337983 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:44:11.338489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:44:11.338973 [debug] [Thread-2 (]: On seed.dbt_playground.products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.products"} */

    create table "shop"."public"."products" ("id" integer,"name" text,"price" float8)
  
[0m15:44:11.339515 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:44:11.340197 [debug] [Thread-1 (]: On seed.dbt_playground.customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "shop", "node_id": "seed.dbt_playground.customers"} */

    create table "shop"."public"."customers" ("id" integer,"name" text,"email" text,"signup_date" date)
  
[0m15:44:11.345198 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.005 seconds
[0m15:44:11.345799 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.005 seconds
[0m15:44:11.375203 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:44:11.376624 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:44:11.377417 [debug] [Thread-1 (]: On seed.dbt_playground.customers: 
          insert into "shop"."public"."customers" ("id", "name", "email", "signup_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m15:44:11.378197 [debug] [Thread-2 (]: On seed.dbt_playground.products: 
          insert into "shop"."public"."products" ("id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m15:44:11.380157 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m15:44:11.381033 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.002 seconds
[0m15:44:11.387935 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_playground.customers"
[0m15:44:11.388724 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_playground.products"
[0m15:44:11.424723 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m15:44:11.427716 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m15:44:11.428302 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_playground.products"
[0m15:44:11.428779 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_playground.customers"
[0m15:44:11.429195 [debug] [Thread-2 (]: On seed.dbt_playground.products: COMMIT
[0m15:44:11.429594 [debug] [Thread-1 (]: On seed.dbt_playground.customers: COMMIT
[0m15:44:11.431177 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:44:11.433400 [debug] [Thread-2 (]: On seed.dbt_playground.products: Close
[0m15:44:11.433805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:44:11.434553 [debug] [Thread-1 (]: On seed.dbt_playground.customers: Close
[0m15:44:11.436466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113ee00c-53a8-4b89-8327-e4a21dea0e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb277fdc2e0>]}
[0m15:44:11.437081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113ee00c-53a8-4b89-8327-e4a21dea0e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb279452350>]}
[0m15:44:11.437835 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.products ..................................... [[32mINSERT 3[0m in 0.16s]
[0m15:44:11.438886 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.customers .................................... [[32mINSERT 3[0m in 0.16s]
[0m15:44:11.439945 [debug] [Thread-2 (]: Finished running node seed.dbt_playground.products
[0m15:44:11.440786 [debug] [Thread-1 (]: Finished running node seed.dbt_playground.customers
[0m15:44:11.443992 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:11.444670 [debug] [MainThread]: On master: BEGIN
[0m15:44:11.445087 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:11.452883 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:44:11.453341 [debug] [MainThread]: On master: COMMIT
[0m15:44:11.453656 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:11.453939 [debug] [MainThread]: On master: COMMIT
[0m15:44:11.454448 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:11.454759 [debug] [MainThread]: On master: Close
[0m15:44:11.455300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:11.455577 [debug] [MainThread]: Connection 'seed.dbt_playground.customers' was properly closed.
[0m15:44:11.455833 [debug] [MainThread]: Connection 'seed.dbt_playground.products' was properly closed.
[0m15:44:11.456179 [info ] [MainThread]: 
[0m15:44:11.456531 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:44:11.457547 [debug] [MainThread]: Command end result
[0m15:44:11.486588 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:44:11.488381 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:44:11.496239 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:44:11.496683 [info ] [MainThread]: 
[0m15:44:11.497166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:11.497582 [info ] [MainThread]: 
[0m15:44:11.498059 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:44:11.499260 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.7383924, "process_in_blocks": "17872", "process_kernel_time": 0.293799, "process_mem_max_rss": "134788", "process_out_blocks": "2632", "process_user_time": 3.920703}
[0m15:44:11.499720 [debug] [MainThread]: Command `dbt seed` succeeded at 15:44:11.499618 after 2.74 seconds
[0m15:44:11.500105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27a49c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27a551660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2773d70d0>]}
[0m15:44:11.500504 [debug] [MainThread]: Flushing usage events
[0m15:44:12.433075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a940c82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a930884f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a93088490>]}


============================== 15:44:12.435928 | 4c89bdc6-05f5-4e12-b716-ea35b63830e7 ==============================
[0m15:44:12.435928 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:44:12.436458 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_path': '/usr/app/dbt_project/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'empty': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True'}
[0m15:44:12.449806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:12.710458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a93088520>]}
[0m15:44:12.802658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a93043220>]}
[0m15:44:12.803356 [info ] [MainThread]: Registered adapter: trino=1.10.0
[0m15:44:12.888240 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:44:13.006913 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:44:13.007356 [debug] [MainThread]: previous checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, current checksum: 7a349c5250085ba503c2d6dda30255fe176921524cc5b3ac67828866ea50a900
[0m15:44:13.007610 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:44:13.007907 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:44:13.008353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a938aeb30>]}
[0m15:44:14.650326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9054b940>]}
[0m15:44:14.750702 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:44:14.752424 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:44:14.758876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9282f2b0>]}
[0m15:44:14.759401 [info ] [MainThread]: Found 3 models, 3 seeds, 3 sources, 455 macros
[0m15:44:14.759746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9282e140>]}
[0m15:44:14.761302 [info ] [MainThread]: 
[0m15:44:14.761647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:44:14.761959 [info ] [MainThread]: 
[0m15:44:14.762492 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:44:14.768974 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m15:44:14.811301 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m15:44:14.811764 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m15:44:14.812044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:14.812295 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:44:14.812745 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a92717490>]}
[0m15:44:14.873706 [debug] [ThreadPool]: SQL status: SUCCESS in 0.062 seconds
[0m15:44:14.875189 [debug] [ThreadPool]: On list_iceberg: Close
[0m15:44:14.876256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_public)
[0m15:44:14.876820 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "public"
"
[0m15:44:14.882307 [debug] [ThreadPool]: Using trino connection "create_iceberg_public"
[0m15:44:14.882738 [debug] [ThreadPool]: On create_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_iceberg_public"} */
create schema if not exists "iceberg"."public"
[0m15:44:14.883058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:14.927900 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.045 seconds
[0m15:44:14.929012 [debug] [ThreadPool]: On create_iceberg_public: COMMIT
[0m15:44:14.929347 [debug] [ThreadPool]: On create_iceberg_public: Close
[0m15:44:14.931111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_public, now list_iceberg_public)
[0m15:44:14.931781 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_public_data'
[0m15:44:14.953252 [debug] [ThreadPool]: Using trino connection "list_iceberg_public"
[0m15:44:14.958739 [debug] [ThreadPool]: Using trino connection "list_iceberg_public_data"
[0m15:44:14.959270 [debug] [ThreadPool]: On list_iceberg_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public'
[0m15:44:14.959667 [debug] [ThreadPool]: On list_iceberg_public_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_iceberg_public_data"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'public_data') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'public_data'
[0m15:44:14.960030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:14.960359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:15.179220 [debug] [ThreadPool]: SQL status: SUCCESS in 0.219 seconds
[0m15:44:15.180539 [debug] [ThreadPool]: SQL status: SUCCESS in 0.220 seconds
[0m15:44:15.182397 [debug] [ThreadPool]: On list_iceberg_public_data: ROLLBACK
[0m15:44:15.183822 [debug] [ThreadPool]: On list_iceberg_public: ROLLBACK
[0m15:44:15.184409 [debug] [ThreadPool]: On list_iceberg_public_data: Close
[0m15:44:15.185008 [debug] [ThreadPool]: On list_iceberg_public: Close
[0m15:44:15.187002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a95d93d90>]}
[0m15:44:15.187824 [debug] [MainThread]: On master: COMMIT
[0m15:44:15.192361 [debug] [Thread-1 (]: Began running node model.dbt_playground.stg_customers
[0m15:44:15.193005 [debug] [Thread-2 (]: Began running node model.dbt_playground.stg_events
[0m15:44:15.193864 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_customers ............................... [RUN]
[0m15:44:15.194575 [info ] [Thread-2 (]: 2 of 3 START sql view model public.stg_events .................................. [RUN]
[0m15:44:15.195286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_public, now model.dbt_playground.stg_customers)
[0m15:44:15.196051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_iceberg_public_data, now model.dbt_playground.stg_events)
[0m15:44:15.196941 [debug] [Thread-1 (]: Began compiling node model.dbt_playground.stg_customers
[0m15:44:15.197557 [debug] [Thread-2 (]: Began compiling node model.dbt_playground.stg_events
[0m15:44:15.201455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_playground.stg_customers"
[0m15:44:15.205446 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_playground.stg_events"
[0m15:44:15.206661 [debug] [Thread-2 (]: Began executing node model.dbt_playground.stg_events
[0m15:44:15.207264 [debug] [Thread-1 (]: Began executing node model.dbt_playground.stg_customers
[0m15:44:15.240320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_playground.stg_customers"
[0m15:44:15.240908 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_playground.stg_events"
[0m15:44:15.242811 [debug] [Thread-2 (]: Using trino connection "model.dbt_playground.stg_events"
[0m15:44:15.244146 [debug] [Thread-1 (]: Using trino connection "model.dbt_playground.stg_customers"
[0m15:44:15.244658 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_events"} */

  create or replace view
    "iceberg"."public"."stg_events"
  security definer
  as
    select
    event_id,
    user_id as customer_id,
    event_type,
    event_time
from "iceberg"."public_data"."events"
  
[0m15:44:15.245148 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.stg_customers"} */

  create or replace view
    "iceberg"."public"."stg_customers"
  security definer
  as
    select
    id as customer_id,
    name,
    email
from "postgres"."public"."customers"
  
[0m15:44:15.245654 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:44:15.246157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:15.633220 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.388 seconds
[0m15:44:15.655742 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: ROLLBACK
[0m15:44:15.656262 [debug] [Thread-2 (]: On model.dbt_playground.stg_events: Close
[0m15:44:15.658877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a905abaf0>]}
[0m15:44:15.659791 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.stg_events ............................. [[32mCREATE VIEW[0m in 0.46s]
[0m15:44:15.660898 [debug] [Thread-2 (]: Finished running node model.dbt_playground.stg_events
[0m15:44:15.708929 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.463 seconds
[0m15:44:15.711423 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: ROLLBACK
[0m15:44:15.711878 [debug] [Thread-1 (]: On model.dbt_playground.stg_customers: Close
[0m15:44:15.712673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9058ba00>]}
[0m15:44:15.713412 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.52s]
[0m15:44:15.714080 [debug] [Thread-1 (]: Finished running node model.dbt_playground.stg_customers
[0m15:44:15.715443 [debug] [Thread-4 (]: Began running node model.dbt_playground.customer_summary
[0m15:44:15.715973 [info ] [Thread-4 (]: 3 of 3 START sql table model public.customer_summary ........................... [RUN]
[0m15:44:15.716523 [debug] [Thread-4 (]: Acquiring new trino connection 'model.dbt_playground.customer_summary'
[0m15:44:15.716857 [debug] [Thread-4 (]: Began compiling node model.dbt_playground.customer_summary
[0m15:44:15.720400 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_playground.customer_summary"
[0m15:44:15.721053 [debug] [Thread-4 (]: Began executing node model.dbt_playground.customer_summary
[0m15:44:15.779305 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_playground.customer_summary"
[0m15:44:15.781633 [debug] [Thread-4 (]: Using trino connection "model.dbt_playground.customer_summary"
[0m15:44:15.782096 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_playground.customer_summary"} */

  
    

    create table "iceberg"."public"."customer_summary"
      
      
    as (
      with customers as (
    select * from "iceberg"."public"."stg_customers"
),
events as (
    select * from "iceberg"."public"."stg_events"
)
select
    c.customer_id,
    c.name,
    count(e.event_id) as total_events
from customers c
left join events e on c.customer_id = e.customer_id
group by 1, 2
    )
[0m15:44:15.782428 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:44:16.872064 [debug] [Thread-4 (]: SQL status: CREATE TABLE (3 rows) in 1.090 seconds
[0m15:44:16.874624 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: ROLLBACK
[0m15:44:16.875132 [debug] [Thread-4 (]: On model.dbt_playground.customer_summary: Close
[0m15:44:16.876006 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c89bdc6-05f5-4e12-b716-ea35b63830e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a904cf760>]}
[0m15:44:16.876729 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.customer_summary ...................... [[32mCREATE TABLE (3 rows)[0m in 1.16s]
[0m15:44:16.877438 [debug] [Thread-4 (]: Finished running node model.dbt_playground.customer_summary
[0m15:44:16.879666 [debug] [MainThread]: On master: COMMIT
[0m15:44:16.880228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:16.880594 [debug] [MainThread]: Connection 'model.dbt_playground.stg_customers' was properly closed.
[0m15:44:16.880905 [debug] [MainThread]: Connection 'model.dbt_playground.stg_events' was properly closed.
[0m15:44:16.881181 [debug] [MainThread]: Connection 'model.dbt_playground.customer_summary' was properly closed.
[0m15:44:16.881539 [info ] [MainThread]: 
[0m15:44:16.881924 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m15:44:16.883112 [debug] [MainThread]: Command end result
[0m15:44:16.916894 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m15:44:16.918763 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m15:44:16.926278 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m15:44:16.926673 [info ] [MainThread]: 
[0m15:44:16.927039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:16.927389 [info ] [MainThread]: 
[0m15:44:16.927889 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:44:16.929512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.574822, "process_in_blocks": "0", "process_kernel_time": 0.319364, "process_mem_max_rss": "127192", "process_out_blocks": "2872", "process_user_time": 3.922195}
[0m15:44:16.930087 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:16.929988 after 4.58 seconds
[0m15:44:16.930439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a940c82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a941574c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a928c4b20>]}
[0m15:44:16.930816 [debug] [MainThread]: Flushing usage events
[0m15:44:17.860849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:14.937582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac73c8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac6380670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac6380610>]}


============================== 15:48:14.943460 | a84564bb-ec6b-40ae-a800-1d6122967799 ==============================
[0m15:48:14.943460 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:48:14.944038 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'invocation_command': 'dbt deps', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True'}
[0m15:48:14.946769 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at `dbt_playground.materialized` in
file `/usr/app/dbt_project/dbt_project.yml`. Hierarchical config values without
a '+' prefix are deprecated in dbt_project.yml.
[0m15:48:14.947229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a84564bb-ec6b-40ae-a800-1d6122967799', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac63c7970>]}
[0m15:48:15.110524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a84564bb-ec6b-40ae-a800-1d6122967799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac63c5450>]}
[0m15:48:15.128174 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:48:15.129362 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:48:15.130026 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:48:15.130930 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2816083, "process_in_blocks": "160", "process_kernel_time": 0.220741, "process_mem_max_rss": "101656", "process_out_blocks": "1424", "process_user_time": 1.595356}
[0m15:48:15.131376 [debug] [MainThread]: Command `dbt deps` succeeded at 15:48:15.131275 after 0.28 seconds
[0m15:48:15.131766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac73c8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac6d2b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac63c5450>]}
[0m15:48:15.132202 [debug] [MainThread]: Flushing usage events
[0m15:48:16.126895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:17.793729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce408c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce30445b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce3044550>]}


============================== 15:48:17.796310 | c8986350-9f9c-4f24-b729-1e18253161d0 ==============================
[0m15:48:17.796310 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:48:17.798905 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'empty': 'None', 'log_path': '/usr/app/dbt_project/logs', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/root/.dbt', 'invocation_command': 'dbt docs serve --port 8081 --host 0.0.0.0 --no-browser', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'version_check': 'True', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m15:48:18.029094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8986350-9f9c-4f24-b729-1e18253161d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce5cf90c0>]}
[0m15:48:18.120393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8986350-9f9c-4f24-b729-1e18253161d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce2f214b0>]}
